% Capitolul 4: Modele SARIMA pentru Serii de Timp Sezoniere
% Prezentare Beamer
% Program de licenta, Academia de Studii Economice din Bucuresti

\documentclass[9pt, aspectratio=169, t]{beamer}

% Ensure content fits on slides
\setbeamersize{text margin left=18mm, text margin right=12mm}

%=============================================================================
% THEME AND STYLE CONFIGURATION
%=============================================================================
\usetheme{Madrid}
\usecolortheme{seahorse}

% IDA-Inspired Color Palette
\definecolor{MainBlue}{RGB}{26, 58, 110}
\definecolor{AccentBlue}{RGB}{42, 82, 140}
\definecolor{IDAred}{RGB}{220, 53, 69}
\definecolor{DarkGray}{RGB}{51, 51, 51}
\definecolor{MediumGray}{RGB}{128, 128, 128}
\definecolor{LightGray}{RGB}{248, 248, 248}
\definecolor{VeryLightGray}{RGB}{235, 235, 235}
\definecolor{Crimson}{RGB}{220, 53, 69}
\definecolor{Forest}{RGB}{46, 125, 50}
\definecolor{Amber}{RGB}{181, 133, 63}

\setbeamercolor{palette primary}{bg=MainBlue, fg=white}
\setbeamercolor{palette secondary}{bg=MainBlue!85, fg=white}
\setbeamercolor{palette tertiary}{bg=MainBlue!70, fg=white}
\setbeamercolor{structure}{fg=MainBlue}
\setbeamercolor{title}{fg=MainBlue}
\setbeamercolor{frametitle}{fg=MainBlue, bg=white}
\setbeamercolor{block title}{bg=MainBlue, fg=white}
\setbeamercolor{block body}{bg=VeryLightGray, fg=DarkGray}
\setbeamercolor{block title alerted}{bg=Crimson, fg=white}
\setbeamercolor{block body alerted}{bg=Crimson!8, fg=DarkGray}
\setbeamercolor{block title example}{bg=Forest, fg=white}
\setbeamercolor{block body example}{bg=Forest!8, fg=DarkGray}
\setbeamercolor{item}{fg=MainBlue}

\setbeamertemplate{navigation symbols}{}

\setbeamertemplate{footline}{
    \leavevmode%
    \hbox{%
        \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.5ex,dp=1ex,center]{author in head/foot}%
            \usebeamerfont{author in head/foot}\insertshortauthor
        \end{beamercolorbox}%
        \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.5ex,dp=1ex,center]{title in head/foot}%
            \usebeamerfont{title in head/foot}\insertshorttitle
        \end{beamercolorbox}%
        \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.5ex,dp=1ex,right]{date in head/foot}%
            \usebeamerfont{date in head/foot}\insertshortdate{}\hspace*{2em}
            \insertframenumber{} / \inserttotalframenumber\hspace*{2ex}
        \end{beamercolorbox}}%
    \vskip0pt%
}

%=============================================================================
% PACKAGES
%=============================================================================
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bm}
\usepackage{tikz}
\usetikzlibrary{arrows.meta, positioning, shapes, calc}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{array}
\usepackage{graphicx}
\usepackage{hyperref}
\hypersetup{colorlinks=false, pdfborder={0 0 0}}
\graphicspath{{logos/}{charts/}}

%=============================================================================
% THEOREM ENVIRONMENTS
%=============================================================================
\theoremstyle{definition}
\setbeamertemplate{theorems}[numbered]
\newtheorem{defn}{Definitie}
\newtheorem{thm}{Teorema}
\newtheorem{prop}{Propozitie}
\newtheorem{rmk}{Observatie}

%=============================================================================
% CUSTOM COMMANDS
%=============================================================================
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\text{Var}}
\newcommand{\Cov}{\text{Cov}}
\newcommand{\Corr}{\text{Corr}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\B}{\mathbf{B}}

%=============================================================================
% TITLE INFORMATION
%=============================================================================
\title[Capitolul 4: Modele SARIMA]{Capitolul 4: Modele SARIMA pentru Serii de Timp Sezoniere}
\subtitle{Program de licenta, Facultatea de Cibernetica, Statistica si Informatica Economica, Academia de Studii Economice din Bucuresti}
\author[Prof. dr. Daniel Traian Pele]{Prof. dr. Daniel Traian Pele\\[0.2cm]\footnotesize\texttt{danpele@ase.ro}}
\institute{Academia de Studii Economice din Bucuresti}
\date{An Universitar 2025--2026}

\begin{document}

%=============================================================================
% TITLE SLIDE
%=============================================================================
\begin{frame}[plain]
    \begin{tikzpicture}[remember picture, overlay]
        \fill[IDAred] (current page.north west) rectangle ([yshift=-0.15cm]current page.north east);
        \node[anchor=north west] at ([xshift=0.5cm, yshift=-0.3cm]current page.north west) {
            \href{https://www.ase.ro}{\includegraphics[height=1.1cm]{ase_logo.png}}
        };
        \node[anchor=north] at ([yshift=-0.3cm]current page.north) {
            \href{https://ai4efin.ase.ro}{\includegraphics[height=1.1cm]{ai4efin_logo.png}}
        };
        \node[anchor=north east] at ([xshift=-0.5cm, yshift=-0.3cm]current page.north east) {
            \href{https://www.digital-finance-msca.com}{\includegraphics[height=1.1cm]{msca_logo.png}}
        };
    \end{tikzpicture}
    \vfill
    \begin{center}
        {\Large\textcolor{MediumGray}{Analiza È™i Prognoza Seriilor de Timp}}\\[0.3cm]
        {\Huge\textbf{\textcolor{MainBlue}{Capitolul 4: Modele SARIMA}}}\\[0.5cm]
        {\Large\textcolor{IDAred}{Serii de Timp Sezoniere}}
    \end{center}
    \vfill

    \begin{tikzpicture}[remember picture, overlay]
        \fill[IDAred] (current page.south west) rectangle ([yshift=0.15cm]current page.south east);
        \node[anchor=south west] at ([xshift=0.5cm, yshift=0.8cm]current page.south west) {
            \href{https://theida.net}{\includegraphics[height=0.9cm]{ida_logo.png}}
        };
        \node[anchor=south] at ([xshift=-3cm, yshift=0.8cm]current page.south) {
            \href{https://blockchain-research-center.com}{\includegraphics[height=0.9cm]{brc_logo.png}}
        };
        \node[anchor=south] at ([yshift=0.8cm]current page.south) {
            \href{https://quantinar.com}{\includegraphics[height=0.9cm]{qr_logo.png}}
        };
        \node[anchor=south] at ([xshift=3cm, yshift=0.8cm]current page.south) {
            \href{https://quantlet.com}{\includegraphics[height=0.9cm]{ql_logo.png}}
        };
        \node[anchor=south east] at ([xshift=-0.5cm, yshift=0.8cm]current page.south east) {
            \href{https://ipe.ro/new}{\includegraphics[height=0.9cm]{acad_logo.png}}
        };
    \end{tikzpicture}
\end{frame}

%=============================================================================
% TABLE OF CONTENTS
%=============================================================================
\begin{frame}{Cuprins}
    \vspace{-0.3cm}
    {\small
    \begin{columns}[T]
        \begin{column}{0.48\textwidth}
            \tableofcontents[sections={1-5}, hideallsubsections]
        \end{column}
        \begin{column}{0.48\textwidth}
            \tableofcontents[sections={6-9}, hideallsubsections]
        \end{column}
    \end{columns}
    }
\end{frame}

%=============================================================================
% MOTIVATION
%=============================================================================
\begin{frame}{Exemplu motivational: Sezonalitatea este peste tot}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.88\textwidth, height=0.62\textheight, keepaspectratio]{charts/ch4_motivation_seasonal.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item Vanzarile cu amanuntul prezinta \textbf{tipare anuale} clare: varfuri in decembrie, minime in ianuarie
        \item Modelele ARIMA standard nu pot captura aceste \textbf{cicluri sezoniere repetitive}
        \item Ignorarea sezonalitatii duce la erori sistematice de prognoza
    \end{itemize}
    }
\end{frame}

\begin{frame}{Intelegerea componentelor sezoniere}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.88\textwidth, height=0.62\textheight, keepaspectratio]{charts/ch4_motivation_decomposition.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item Serie de timp sezoniera = \textbf{Trend} + \textbf{Tipar sezonier} + \textbf{Reziduuri}
        \item Descompunerea ajuta la vizualizarea separata a fiecarei componente
        \item Modelele SARIMA capteaza atat dinamica trendului, cat si comportamentul sezonier
    \end{itemize}
    }
\end{frame}

\begin{frame}{Aplicatie reala: Tipare lunare}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.88\textwidth, height=0.62\textheight, keepaspectratio]{charts/ch4_motivation_monthly.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item Cererea de energie prezinta o \textbf{sezonalitate lunara} puternica (cicluri de incalzire/racire)
        \item Tiparul se repeta previzibil in fiecare an cu mici variatii
        \item Companiile de utilitati folosesc prognozele SARIMA pentru planificarea capacitatii
    \end{itemize}
    }
\end{frame}

\begin{frame}{De ce avem nevoie de SARIMA?}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.88\textwidth, height=0.62\textheight, keepaspectratio]{charts/ch4_motivation_why_sarima.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item \textbf{Stanga}: ACF sezoniera prezinta varfuri la lag-urile 12, 24, 36... (tipar anual)
        \item \textbf{Dreapta}: Reziduurile ARIMA inca prezinta autocorelatie sezoniera --- modelul este incomplet
        \item SARIMA adauga \textbf{termeni AR si MA sezonieri} pentru a captura aceste tipare
    \end{itemize}
    }
\end{frame}

\begin{frame}{Ce vom invata astazi}
    {\small
    \hfill\begin{minipage}{0.9\textwidth}
        \begin{columns}[T]
            \begin{column}{0.48\textwidth}
                \begin{block}{Concepte}
                    \begin{itemize}\setlength{\itemsep}{1pt}
                        \item Identificarea tiparelor sezoniere
                        \item Operatorul de diferentiere sezoniera
                        \item Notatia SARIMA$(p,d,q)(P,D,Q)_s$
                        \item Celebrul ``Model Airline''
                        \item Selectia modelului pentru date sezoniere
                    \end{itemize}
                \end{block}
            \end{column}
            \begin{column}{0.48\textwidth}
                \begin{block}{Abilitati}
                    \begin{itemize}\setlength{\itemsep}{1pt}
                        \item Diagnosticarea sezonalitatii din ACF/PACF
                        \item Determinarea perioadei sezoniere $s$
                        \item Alegerea ordinelor sezoniere $(P, D, Q)$
                        \item Implementarea SARIMA in Python/R
                        \item Prognoza seriilor de timp sezoniere
                    \end{itemize}
                \end{block}
            \end{column}
        \end{columns}
    \end{minipage}
    }

    \vspace{0.3cm}

    \begin{alertblock}{Ideea cheie}
        SARIMA = ARIMA aplicat la \textbf{doua frecvente}: nivelul obisnuit (pe termen scurt) si cel sezonier (pe termen lung)
    \end{alertblock}
\end{frame}

%=============================================================================
% SECTION 1: SEASONALITY IN TIME SERIES
%=============================================================================
\section{Sezonalitatea in seriile de timp}

\begin{frame}{Ce este sezonalitatea?}
    \begin{defn}[Sezonalitate]
        O serie de timp prezinta \textbf{sezonalitate} cand arata fluctuatii regulate, periodice care se repeta pe o perioada fixa $s$ (perioada sezoniera).
    \end{defn}

    \vspace{0.1cm}

    \begin{exampleblock}{Perioade sezoniere comune}
        \begin{itemize}
            \item Date lunare: $s = 12$ (ciclu anual)
            \item Date trimestriale: $s = 4$ (ciclu anual)
            \item Date saptamanale: $s = 52$ (anual) sau $s = 7$ (tipar saptamanal)
            \item Date zilnice: $s = 7$ (tipar saptamanal)
        \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Sezonalitatea: Ilustrare vizuala}
    \begin{center}
        \includegraphics[width=0.95\textwidth]{charts/ch4_def_seasonality.pdf}
    \end{center}
    \vspace{-0.2cm}
    \small Stanga: date lunare cu perioada sezoniera $s=12$. Dreapta: date trimestriale cu $s=4$.
\end{frame}

\begin{frame}{Exemple de date sezoniere}
	{\small
		\hfill\begin{minipage}{0.9\textwidth}
			\begin{columns}[T]
				\begin{column}{0.48\textwidth}
					\begin{block}{Serii economice}
						\begin{itemize}\setlength{\itemsep}{0pt}
							\item Vanzari cu amanuntul (varfuri de sarbatori)
							\item Turism (vara/iarna)
							\item Productie agricola
							\item Consum de energie
							\item Ocuparea fortei de munca (cicluri de angajare)
						\end{itemize}
					\end{block}
				\end{column}
				\begin{column}{0.48\textwidth}
					\begin{block}{Alte domenii}
						\begin{itemize}\setlength{\itemsep}{0pt}
							\item Vreme/temperatura
							\item Trafic pe site-uri web
							\item Admisii la spital
							\item Utilizarea transportului
							\item Cererea de electricitate
						\end{itemize}
					\end{block}
				\end{column}
			\end{columns}
		\end{minipage}
	}
	\begin{alertblock}{De ce conteaza}
		Ignorarea sezonalitatii duce la prognoze distorsionate si inferenta invalida!
	\end{alertblock}
\end{frame}

\begin{frame}{Exemplu: Datele privind pasagerii companiilor aeriene}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.78\textwidth, height=0.55\textheight, keepaspectratio]{charts/ch4_airline_data.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\small
    \begin{itemize}
        \item Pasageri internationali lunari ai companiilor aeriene (1949--1960)
        \item \textbf{Trend ascendent} clar si \textbf{amplitudine sezoniera crescatoare}
        \item Varfurile din vara reflecta tiparele calatoriilor de vacanta
    \end{itemize}
    }
\end{frame}

\begin{frame}{Vizualizarea tiparelor sezoniere}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.78\textwidth, height=0.58\textheight, keepaspectratio]{charts/ch4_seasonal_boxplot.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item Diagrama box plot releva un tipar sezonier consistent de-a lungul anilor
        \item Iulie--August prezinta cele mai mari numere de pasageri (calatorii de vara)
        \item Noiembrie--Februarie prezinta cele mai mici numere (lunile de iarna)
    \end{itemize}
    }
\end{frame}

\begin{frame}{Sezonalitate determinista vs stocastica}
    {\small
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{columns}[T]
        \begin{column}{0.48\textwidth}
            \begin{block}{Sezonalitate determinista}
                Tipar sezonier fix:
                $Y_t = \sum_{j=1}^{s} \gamma_j D_{jt} + \varepsilon_t$
                unde $D_{jt}$ sunt variabile dummy sezoniere.

                \textbf{Proprietati:}
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Tiparul constant in timp
                    \item Eliminat prin regresie
                \end{itemize}
            \end{block}
        \end{column}
        \begin{column}{0.48\textwidth}
            \begin{block}{Sezonalitate stocastica}
                Tipar sezonier in evolutie:
                $\Delta_s Y_t = Y_t - Y_{t-s}$
                prezinta structura de dependenta.

                \textbf{Proprietati:}
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Tiparul evolueaza in timp
                    \item Necesita diferentiere sezoniera
                \end{itemize}
            \end{block}
        \end{column}
    \end{columns}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Detectarea sezonalitatii}
    {\small
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Metode vizuale}
        \begin{itemize}
            \item Graficul seriei de timp -- cautati tipare repetitive
            \item Graficul sub-seriilor sezoniere -- comparati aceleasi sezoane de-a lungul anilor
            \item Graficul ACF -- varfuri la lag-uri sezoniere ($s, 2s, 3s, \ldots$)
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{block}{Teste statistice}
        \begin{itemize}
            \item Teste de radacina unitara sezoniera (HEGY, CH, OCSB)
            \item Testul F pentru variabile dummy sezoniere
            \item Testul Kruskal-Wallis (neparametric)
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{exampleblock}{Semnatura ACF}
        Sezonalitate puternica: ACF prezinta varfuri semnificative la lag-urile $s, 2s, 3s, \ldots$
    \end{exampleblock}
    \end{minipage}
    }
\end{frame}

\begin{frame}{ACF releva structura sezoniera}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.82\textwidth, height=0.55\textheight, keepaspectratio]{charts/ch4_acf_seasonality.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item \textbf{Descrestere lenta} la toate lag-urile indica nestationaritate (trend)
        \item \textbf{Varfuri la lag-urile 12, 24, 36} confirma tiparul sezonier ($s=12$)
        \item ACF la lag-urile sezoniere prezinta descrestere lenta $\Rightarrow$ necesita diferentiere sezoniera
    \end{itemize}
    }
\end{frame}

\begin{frame}{Testul F pentru variabile dummy sezoniere: Intuitie}
    {\small
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Ce face acest test?}
        Testeaza daca \textbf{valorile medii difera semnificativ intre sezoane}.
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Daca media din ianuarie $\neq$ media din februarie $\neq$ ... $\neq$ media din decembrie $\Rightarrow$ sezonalitate
            \item Compara un model CU variabile dummy sezoniere vs. un model FARA
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{block}{Modelele comparate}
        \textbf{Restrictionat}: $Y_t = \alpha + \varepsilon_t$ \quad \textbf{Nerestictionat}: $Y_t = \alpha + \sum_{j=1}^{s-1} \gamma_j D_{jt} + \varepsilon_t$

        unde $D_{jt} = 1$ daca observatia $t$ este in sezonul $j$, 0 altfel.
    \end{block}

    \vspace{0.1cm}

    \begin{alertblock}{Ideea cheie}
        Daca adaugarea variabilelor dummy sezoniere \textbf{reduce semnificativ} erorile de predictie, atunci sezonalitatea este prezenta.
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Testul F pentru variabile dummy sezoniere: Formula si exemplu}
    \begin{block}{Formula statisticii F}
        $$F = \frac{(SSR_R - SSR_U)/(s-1)}{SSR_U/(n-s)} \sim F_{s-1, n-s}$$
        \begin{itemize}
            \item $SSR_R$ = Suma patratelor reziduurilor din modelul restrictionat (fara dummy)
            \item $SSR_U$ = Suma patratelor reziduurilor din modelul nerestrictionat (cu dummy)
            \item $s-1$ = numarul de restrictii (lunar: 11, trimestrial: 3)
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{exampleblock}{Exemplu numeric (Date lunare, n=120)}
        $SSR_R = 15000$, $SSR_U = 8500$, $s = 12$

        $$F = \frac{(15000 - 8500)/11}{8500/108} = \frac{590.9}{78.7} = 7.51$$

        Valoarea critica $F_{0.05, 11, 108} \approx 1.87$. Deoarece $7.51 > 1.87$: \textbf{Respingem $H_0$} $\Rightarrow$ Sezonalitate prezenta!
    \end{exampleblock}
\end{frame}

\begin{frame}{Testul Kruskal-Wallis: Intuitie}
    {\small
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Ce face acest test?}
        Un test \textbf{neparametric} care verifica daca observatiile din diferite sezoane provin din aceeasi distributie.
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Functioneaza prin \textbf{ordonarea} tuturor observatiilor de la cea mai mica la cea mai mare
            \item Verifica daca rangurile sunt distribuite uniform intre sezoane
            \item Daca un sezon are in mod constant ranguri mai mari/mici $\Rightarrow$ sezonalitate
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{exampleblock}{De ce sa-l folosim in locul testului F?}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Fara ipoteza de normalitate} -- functioneaza cu orice distributie
            \item \textbf{Robust la valori extreme} -- valorile extreme nu distorsioneaza rezultatele
        \end{itemize}
    \end{exampleblock}

    \vspace{0.1cm}

    \begin{alertblock}{Limitare}
        Mai putin puternic decat testul F cand datele SUNT distribuite normal.
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Testul Kruskal-Wallis: Formula si exemplu}
    {\footnotesize
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Statistica de test}
        $H = \frac{12}{N(N+1)} \sum_{j=1}^{s} \frac{R_j^2}{n_j} - 3(N+1)$ \quad unde $N$ = total obs., $n_j$ = obs. in sezonul $j$, $R_j$ = suma rangurilor.
    \end{block}

    \begin{exampleblock}{Exemplu: Vanzari trimestriale (n=20, s=4)}
        Date ordonate 1-20. Sumele rangurilor: T1: $R_1 = 15$, T2: $R_2 = 35$, T3: $R_3 = 70$, T4: $R_4 = 90$
        $$H = \frac{12}{20 \times 21}\left(\frac{15^2}{5} + \frac{35^2}{5} + \frac{70^2}{5} + \frac{90^2}{5}\right) - 3(21) = 12.6$$
        Valoarea critica $\chi^2_{0.05, 3} = 7.81$. Deoarece $12.6 > 7.81$: \textbf{Respingem $H_0$} $\Rightarrow$ Sezonalitate!
    \end{exampleblock}

    \begin{alertblock}{In Python}
        \texttt{scipy.stats.kruskal(q1, q2, q3, q4)}
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Testul HEGY: Ce problema rezolva?}
    {\small
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Intrebarea cheie}
        Avand o serie de timp sezoniera, trebuie sa stim:
        \begin{enumerate}\setlength{\itemsep}{0pt}
            \item Are nevoie de \textbf{diferentiere obisnuita} $(1-L)$? $\Rightarrow$ setam $d=1$
            \item Are nevoie de \textbf{diferentiere sezoniera} $(1-L^s)$? $\Rightarrow$ setam $D=1$
        \end{enumerate}
        HEGY testeaza pentru \textbf{ambele} tipuri de radacini unitare simultan!
    \end{block}

    \begin{exampleblock}{De ce sa nu folosim doar ADF?}
        ADF testeaza doar pentru o radacina unitara \textbf{obisnuita} la frecventa zero. Datele sezoniere pot avea radacini unitare la \textbf{frecvente sezoniere} pe care ADF le omite!
    \end{exampleblock}

    \begin{alertblock}{HEGY testeaza frecvente multiple}
        Trimestrial: testeaza la 0, $\pi$, $\pm\pi/2$. Lunar: testeaza la 0, $\pi$, $\pm\pi/6$, $\pm\pi/3$, $\pm\pi/2$, $\pm 2\pi/3$, $\pm 5\pi/6$.
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Testul HEGY: Formula de regresie (Trimestrial)}
    {\footnotesize
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Regresia auxiliara HEGY}
        Pentru date trimestriale ($s=4$), estimam:
        $$\Delta_4 y_t = \pi_1 z_{1,t-1} + \pi_2 z_{2,t-1} + \pi_3 z_{3,t-2} + \pi_4 z_{4,t-2} + \sum_{j=1}^{k} \phi_j \Delta_4 y_{t-j} + \varepsilon_t$$
    \end{block}
    \vspace{-0.1cm}
    \begin{block}{Variabile transformate}
        \vspace{-0.3cm}
        \begin{align*}
            z_{1t} &= (1+L+L^2+L^3)y_t = y_t + y_{t-1} + y_{t-2} + y_{t-3} \\[-0.1cm]
            z_{2t} &= -(1-L+L^2-L^3)y_t = -y_t + y_{t-1} - y_{t-2} + y_{t-3} \\[-0.1cm]
            z_{3t} &= -(1-L^2)y_t = -y_t + y_{t-2} \quad;\quad z_{4t} = -(L-L^3)y_t = -y_{t-1} + y_{t-3}
        \end{align*}
        \vspace{-0.3cm}
    \end{block}
    \vspace{-0.1cm}
    \begin{alertblock}{Ipoteze}
        $H_0: \pi_1=0$ (frecv.\ 0), $H_0: \pi_2=0$ (frecv.\ $\pi$), $H_0: \pi_3=\pi_4=0$ (frecv.\ $\pm\pi/2$)
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Testul HEGY: Reguli de decizie cu exemple}
    {\footnotesize
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Valori critice HEGY (5\%, n=100, cu constanta)}
        \begin{tabular}{lccc}
            \toprule
            Test & Statistica & Valoare critica & Daca NU este respins... \\
            \midrule
            $t_1$ ($\pi_1=0$) & t-stat & $-2.88$ & Necesita $d=1$ \\
            $t_2$ ($\pi_2=0$) & t-stat & $-2.88$ & Necesita $D=1$ \\
            $F_{34}$ ($\pi_3=\pi_4=0$) & F-stat & $6.57$ & Necesita $D=1$ \\
            \bottomrule
        \end{tabular}
    \end{block}

    \begin{exampleblock}{Exemplu: PIB trimestrial}
        Sa presupunem ca HEGY da: $t_1 = -1.52$, $t_2 = -4.21$, $F_{34} = 2.15$
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $t_1 = -1.52 > -2.88$: Nu putem respinge $\Rightarrow$ \textbf{necesita $d=1$}
            \item $t_2 = -4.21 < -2.88$: Respingem $\Rightarrow$ fara radacina unitara la $\pi$
            \item $F_{34} = 2.15 < 6.57$: Nu putem respinge $\Rightarrow$ \textbf{necesita $D=1$}
        \end{itemize}
        \textbf{Concluzie}: Folosim SARIMA cu $d=1, D=1$
    \end{exampleblock}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Testul Canova-Hansen: Opusul testului HEGY}
    {\footnotesize
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{HEGY vs Canova-Hansen: Ipoteze nule diferite!}
        \begin{center}
        \begin{tabular}{lcc}
            \toprule
            & \textbf{HEGY} & \textbf{Canova-Hansen} \\
            \midrule
            $H_0$ & Radacina unitara sezoniera & \textbf{Fara} radacina unitara sezoniera \\
            $H_1$ & Fara radacina unitara sezoniera & Radacina unitara sezoniera \\
            \midrule
            Respingem $H_0$ & Folosim variabile dummy sezoniere & Folosim diferentiere $(1-L^s)$ \\
            Nu respingem & Folosim diferentiere $(1-L^s)$ & Folosim variabile dummy sezoniere \\
            \bottomrule
        \end{tabular}
        \end{center}
    \end{block}

    \begin{alertblock}{De ce conteaza?}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item HEGY: ``Demonstrati ca NU exista radacina unitara'' (conservator fata de diferentiere)
            \item CH: ``Demonstrati ca EXISTA radacina unitara'' (conservator fata de variabile dummy)
            \item Folositi \textbf{ambele} teste pentru concluzii robuste!
        \end{itemize}
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Testul Canova-Hansen: Formula}
    {\footnotesize
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Procedura de testare}
        1. Regresam $y_t$ pe variabile dummy sezoniere: $y_t = \sum_{j=1}^{s} \gamma_j D_{jt} + u_t$

        2. Calculam sumele partiale la frecventa sezoniera $\lambda_i$:
        $S_{it}^{(c)} = \sum_{j=1}^{t} \hat{u}_j \cos(\lambda_i j)$, \; $S_{it}^{(s)} = \sum_{j=1}^{t} \hat{u}_j \sin(\lambda_i j)$
    \end{block}
    \vspace{-0.1cm}
    \begin{block}{Statistica de test LM}
        $$LM_i = \frac{1}{T^2 \hat{\omega}_i} \left[ \sum_{t=1}^{T} (S_{it}^{(c)})^2 + \sum_{t=1}^{T} (S_{it}^{(s)})^2 \right]$$
        unde $\hat{\omega}_i$ = estimator consistent al densitatii spectrale la frecventa $\lambda_i$.
    \end{block}
    \vspace{-0.1cm}
    \begin{alertblock}{Decizie}
        Respingem $H_0$ (stationaritate) daca $LM > $ valoare critica $\Rightarrow$ este necesara diferentierea sezoniera.
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Sumar: Alegerea testului de sezonalitate potrivit}
    {\footnotesize
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{center}
    \begin{tabular}{p{2cm}p{2.5cm}p{2.5cm}p{3cm}}
        \toprule
        \textbf{Test} & \textbf{$H_0$} & \textbf{Daca respingem} & \textbf{Cel mai bun pentru} \\
        \midrule
        Test F & Fara sezonalitate & Sezonalitate exista & Date normale \\
        Kruskal-Wallis & Fara dif. sezoniera & Sezonalitate exista & Non-normale, valori extreme \\
        HEGY & Radacina unitara exista & Folosim dummy & Determinarea $d$, $D$ \\
        Canova-Hansen & Fara radacina unitara & Folosim $(1-L^s)$ & Confirmarea stabilitatii \\
        \bottomrule
    \end{tabular}
    \end{center}

    \vspace{0.1cm}

    \begin{alertblock}{Ideea cheie}
        Test F/Kruskal-Wallis: ``\textit{Exista sezonalitate?}'' \\
        HEGY/Canova-Hansen: ``\textit{Ce tip?}'' (determinista vs stocastica)
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

%=============================================================================
% SECTION 2: SEASONAL DIFFERENCING
%=============================================================================
\section{Diferentierea sezoniera}

\begin{frame}{Operatorul de diferenta sezoniera}
    \begin{defn}[Diferenta sezoniera]
        \textbf{Operatorul de diferenta sezoniera} $\Delta_s$ este definit ca:
        $$\Delta_s Y_t = (1 - L^s) Y_t = Y_t - Y_{t-s}$$
        unde $L^s Y_t = Y_{t-s}$ este operatorul de lag sezonier.
    \end{defn}

    \vspace{0.1cm}

    \begin{exampleblock}{Exemple}
        \begin{itemize}
            \item Date lunare ($s=12$): $\Delta_{12} Y_t = Y_t - Y_{t-12}$

            Compara fiecare luna cu aceeasi luna din anul trecut
            \item Date trimestriale ($s=4$): $\Delta_4 Y_t = Y_t - Y_{t-4}$

            Compara fiecare trimestru cu acelasi trimestru din anul trecut
        \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Diferenta sezoniera: Ilustrare vizuala}
    \begin{center}
        \includegraphics[width=0.95\textwidth]{charts/ch4_def_seasonal_diff.pdf}
    \end{center}
    \vspace{-0.2cm}
    \small Stanga: seria originala cu tipar sezonier. Dreapta: dupa $\Delta_{12}$, tiparul sezonier este eliminat.
\end{frame}

\begin{frame}{Combinarea diferentierii obisnuite si sezoniere}
    \begin{block}{Diferentiere completa}
        Pentru serii cu atat trend cat si sezonalitate:
        $$\Delta \Delta_s Y_t = (1-L)(1-L^s) Y_t$$
    \end{block}

    \vspace{0.1cm}

    \begin{exampleblock}{Dezvoltare}
        $(1-L)(1-L^s) Y_t = Y_t - Y_{t-1} - Y_{t-s} + Y_{t-s-1}$

        Pentru date lunare ($s=12$):
        $$\Delta \Delta_{12} Y_t = Y_t - Y_{t-1} - Y_{t-12} + Y_{t-13}$$
    \end{exampleblock}

    \vspace{0.1cm}

    \begin{alertblock}{Ordinea diferentierii}
        \begin{itemize}
            \item $d$: numarul de diferente obisnuite (eliminarea trendului)
            \item $D$: numarul de diferente sezoniere (eliminarea trendului sezonier)
        \end{itemize}
    \end{alertblock}
\end{frame}

\begin{frame}{Efectul operatiilor de diferentiere}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.82\textwidth, height=0.6\textheight, keepaspectratio]{charts/ch4_differencing_effect.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item Diferentierea obisnuita elimina trendul dar tiparul sezonier ramane
        \item Diferentierea sezoniera elimina sezonalitatea dar tiparul de trend ramane
        \item \textbf{Ambele diferente} sunt necesare pentru a atinge stationaritatea
    \end{itemize}
    }
\end{frame}

\begin{frame}{ACF inainte si dupa diferentiere}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.82\textwidth, height=0.6\textheight, keepaspectratio]{charts/ch4_acf_differencing.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item ACF originala: descrestere lenta indica nestationaritate
        \item Dupa $\Delta$: varfuri sezoniere raman la lag-urile 12, 24, 36
        \item Dupa $\Delta_{12}$: descresterea de trend ramane la lag-urile initiale
        \item Dupa $\Delta\Delta_{12}$: ACF se opreste brusc $\Rightarrow$ \textbf{stationara}
    \end{itemize}
    }
\end{frame}

\begin{frame}{Integrare sezoniera}
    \begin{defn}[Proces integrat sezonier]
        O serie $Y_t$ este \textbf{integrata sezonier} de ordinul $(d, D)_s$, scrisa $Y_t \sim I(d, D)_s$, daca:
        $$(1-L)^d (1-L^s)^D Y_t$$
        este stationara.
    \end{defn}

    \vspace{0.1cm}

    \begin{exampleblock}{Cazuri comune}
        \begin{itemize}
            \item $I(1,0)_{12}$: Doar radacina unitara obisnuita (lunara)
            \item $I(0,1)_{12}$: Doar radacina unitara sezoniera
            \item $I(1,1)_{12}$: Atat radacina unitara obisnuita cat si sezoniera
        \end{itemize}
    \end{exampleblock}
\end{frame}

%=============================================================================
% SECTION 3: SARIMA MODEL DEFINITION
%=============================================================================
\section{Modelul SARIMA}

\begin{frame}{Definitia modelului SARIMA}
    \begin{defn}[SARIMA$(p,d,q)\times(P,D,Q)_s$]
        Modelul \textbf{Seasonal ARIMA} este:
        $$\phi(L)\Phi(L^s)(1-L)^d(1-L^s)^D Y_t = c + \theta(L)\Theta(L^s)\varepsilon_t$$
    \end{defn}

    {\footnotesize
    \begin{block}{Componente}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $\phi(L) = 1 - \phi_1 L - \cdots - \phi_p L^p$: AR non-sezonier
            \item $\Phi(L^s) = 1 - \Phi_1 L^s - \cdots - \Phi_P L^{Ps}$: AR sezonier
            \item $\theta(L) = 1 + \theta_1 L + \cdots + \theta_q L^q$: MA non-sezonier
            \item $\Theta(L^s) = 1 + \Theta_1 L^s + \cdots + \Theta_Q L^{Qs}$: MA sezonier
            \item $(1-L)^d$: Diferentiere obisnuita; $(1-L^s)^D$: Diferentiere sezoniera
        \end{itemize}
    \end{block}
    }
\end{frame}

\begin{frame}{SARIMA: Ilustrare vizuala}
    \begin{center}
        \includegraphics[width=0.95\textwidth]{charts/ch4_def_sarima.pdf}
    \end{center}
    \vspace{-0.2cm}
    \small Diferentiere progresiva: originala $\to$ dif. obisnuita $\to$ dif. sezoniera $\to$ ambele diferente.
\end{frame}

\begin{frame}{Notatia SARIMA}
    \begin{block}{Specificatie completa}
        SARIMA$(p,d,q)\times(P,D,Q)_s$ are 7 parametri de specificat:
    \end{block}

    \vspace{0.1cm}

    \begin{table}
        \centering
        \small
        \begin{tabular}{ll}
            \toprule
            \textbf{Parametru} & \textbf{Semnificatie} \\
            \midrule
            $p$ & Ordinul AR non-sezonier \\
            $d$ & Ordinul diferentierii non-sezoniere \\
            $q$ & Ordinul MA non-sezonier \\
            $P$ & Ordinul AR sezonier \\
            $D$ & Ordinul diferentierii sezoniere \\
            $Q$ & Ordinul MA sezonier \\
            $s$ & Perioada sezoniera \\
            \bottomrule
        \end{tabular}
    \end{table}

    \vspace{0.1cm}

    \begin{exampleblock}{Exemplu}
        {\small SARIMA$(1,1,1)\times(1,1,1)_{12}$: Date lunare cu AR(1), MA(1), AR sezonier(1), MA sezonier(1), si atat diferentiere obisnuita cat si sezoniera.}
    \end{exampleblock}
\end{frame}

\begin{frame}{Modele SARIMA comune}
    {\small
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Modelul Airline: SARIMA$(0,1,1)\times(0,1,1)_s$}
        $(1-L)(1-L^s)Y_t = (1+\theta L)(1+\Theta L^s)\varepsilon_t$ -- Model clasic (Box \& Jenkins, 1970)
    \end{block}

    \begin{block}{SARIMA$(1,0,0)\times(1,0,0)_s$}
        $(1-\phi L)(1-\Phi L^s)Y_t = \varepsilon_t$ -- AR sezonier si non-sezonier pur
    \end{block}

    \begin{block}{SARIMA$(0,1,1)\times(0,1,0)_s$}
        $(1-L)(1-L^s)Y_t = (1+\theta L)\varepsilon_t$ -- Random walk + dif. sezoniera + MA(1)
    \end{block}
    \end{minipage}
    }
\end{frame}

\begin{frame}{Structura multiplicativa}
    \begin{block}{De ce multiplicativa?}
        Partile sezoniera si non-sezoniera se \textbf{inmultesc}:
        $$\phi(L)\Phi(L^s) \quad \text{si} \quad \theta(L)\Theta(L^s)$$
    \end{block}

    \vspace{0.1cm}

    \begin{exampleblock}{Exemplu: SARIMA$(1,0,0)\times(1,0,0)_{12}$}
        $(1-\phi L)(1-\Phi L^{12})Y_t = \varepsilon_t$

        Dezvoltand:
        $Y_t - \phi Y_{t-1} - \Phi Y_{t-12} + \phi\Phi Y_{t-13} = \varepsilon_t$

        Termenul incrucist $\phi\Phi Y_{t-13}$ capteaza interactiunea!
    \end{exampleblock}

    \vspace{0.1cm}

    \begin{alertblock}{Interpretare}
        Structura multiplicativa permite modelarea parsimoniasa a tiparelor sezoniere complexe cu putini parametri.
    \end{alertblock}
\end{frame}

%=============================================================================
% SECTION 4: SEASONAL ACF AND PACF
%=============================================================================
\section{Tipare ACF si PACF sezoniere}

\begin{frame}{ACF/PACF pentru modele sezoniere}
    \begin{block}{Ideea cheie}
        Modelele sezoniere prezinta tipare la ambele:
        \begin{itemize}
            \item Lag-uri non-sezoniere: $1, 2, 3, \ldots$
            \item Lag-uri sezoniere: $s, 2s, 3s, \ldots$
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{table}
        \centering
        \small
        \begin{tabular}{lcc}
            \toprule
            \textbf{Model} & \textbf{ACF} & \textbf{PACF} \\
            \midrule
            SAR($P$) & Descreste la $s, 2s, \ldots$ & Se opreste dupa $Ps$ \\
            SMA($Q$) & Se opreste dupa $Qs$ & Descreste la $s, 2s, \ldots$ \\
            SARMA & Descreste la lag-uri sezoniere & Descreste la lag-uri sezoniere \\
            \bottomrule
        \end{tabular}
    \end{table}
\end{frame}

\begin{frame}{Exemplu: ACF/PACF pentru modelul Airline}
    \begin{block}{SARIMA$(0,1,1)\times(0,1,1)_{12}$}
        Dupa diferentiere $W_t = (1-L)(1-L^{12})Y_t$:
        $$W_t = (1+\theta L)(1+\Theta L^{12})\varepsilon_t$$
    \end{block}

    \vspace{0.1cm}

    {\small
    \begin{exampleblock}{Tiparul ACF asteptat}
        \begin{itemize}
            \item Varf la lag-ul 1 (de la $\theta$)
            \item Varf la lag-ul 12 (de la $\Theta$)
            \item Varf la lag-ul 13 (de la interactiunea $\theta \cdot \Theta$)
            \item Toate celelalte lag-uri aproape de zero
        \end{itemize}
    \end{exampleblock}

    \begin{exampleblock}{Tiparul PACF asteptat}
        \begin{itemize}
            \item Descrestere exponentiala la lag-urile $1, 2, 3, \ldots$
            \item Descrestere exponentiala la lag-urile $12, 24, 36, \ldots$
        \end{itemize}
    \end{exampleblock}
    }
\end{frame}

\begin{frame}{Ghid de identificare a modelului}
    {\small
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Proces pas cu pas}
        \begin{enumerate}
            \item Examinati ACF pentru descrestere lenta la lag-uri sezoniere $\Rightarrow$ diferentiere sezoniera
            \item Dupa diferentiere, verificati tiparele ACF/PACF
            \item Comportamentul non-sezonier la lag-urile $1, 2, \ldots, s-1$
            \item Comportamentul sezonier la lag-urile $s, 2s, 3s, \ldots$
        \end{enumerate}
    \end{block}

    \vspace{0.1cm}

    \begin{alertblock}{Sfaturi practice}
        \begin{itemize}
            \item Incepeti cu $d \leq 1$ si $D \leq 1$
            \item De obicei $P, Q \leq 2$ este suficient
            \item Folositi criterii informationale (AIC, BIC) pentru selectia finala
            \item Algoritmii Auto-SARIMA pot ajuta
        \end{itemize}
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

%=============================================================================
% SECTION 5: ESTIMATION AND DIAGNOSTICS
%=============================================================================
\section{Estimare si diagnosticare}

\begin{frame}{Metode de estimare}
    \begin{block}{Estimare prin verosimilitate maxima}
        Abordare standard pentru SARIMA:
        \begin{itemize}
            \item MLE conditionata (conditionata de valorile initiale)
            \item MLE exacta (prin filtrul Kalman)
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{block}{Consideratii computationale}
        \begin{itemize}
            \item Mai multi parametri decat ARIMA $\Rightarrow$ mai multe date necesare
            \item Parametrii sezonieri estimati din lag-urile $s, 2s, \ldots$
            \item Necesita suficiente cicluri sezoniere (cel putin 3-4 ani de date lunare)
        \end{itemize}
    \end{block}
\end{frame}

\begin{frame}{Stationaritate si invertibilitate}
    \begin{block}{Conditii de stationaritate}
        Atat polinoamele AR non-sezoniere cat si sezoniere trebuie sa aiba radacini in afara cercului unitate:
        \begin{itemize}
            \item $\phi(z) = 0 \Rightarrow |z| > 1$
            \item $\Phi(z^s) = 0 \Rightarrow |z| > 1$
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{block}{Conditii de invertibilitate}
        Atat polinoamele MA non-sezoniere cat si sezoniere trebuie sa aiba radacini in afara cercului unitate:
        \begin{itemize}
            \item $\theta(z) = 0 \Rightarrow |z| > 1$
            \item $\Theta(z^s) = 0 \Rightarrow |z| > 1$
        \end{itemize}
    \end{block}
\end{frame}

\begin{frame}{Verificarea diagnosticarii}
    \begin{block}{Analiza reziduurilor}
        Dupa ajustarea SARIMA, verificati ca reziduurile sunt zgomot alb:
        \begin{enumerate}
            \item Graficul reziduurilor in timp (fara tipare)
            \item ACF a reziduurilor (fara varfuri semnificative)
            \item Testul Ljung-Box la lag-uri multiple inclusiv sezoniere
            \item Teste de normalitate (grafic Q-Q, Jarque-Bera)
        \end{enumerate}
    \end{block}

    \vspace{0.1cm}

    \begin{alertblock}{Important}
        Verificati ACF la \textbf{ambele} lag-uri non-sezoniere si sezoniere!

        ACF semnificativa la lag-ul 12 sugereaza modelare sezoniera inadecvata.
    \end{alertblock}
\end{frame}

\begin{frame}{Criterii de selectie a modelului}
    \begin{block}{Criterii informationale}
        Comparati modelele SARIMA concurente folosind:
        \begin{itemize}
            \item AIC = $-2\ln(L) + 2k$
            \item BIC = $-2\ln(L) + k\ln(n)$
            \item AICc = AIC + $\frac{2k(k+1)}{n-k-1}$ (corectat pentru esantioane mici)
        \end{itemize}
        unde $k = p + q + P + Q + 1$ (plus 1 pentru varianta).
    \end{block}

    \vspace{0.1cm}

    \begin{exampleblock}{Auto-SARIMA}
        \texttt{pmdarima.auto\_arima()} din Python cu \texttt{seasonal=True} cauta automat $(p,d,q)\times(P,D,Q)_s$ optim.
    \end{exampleblock}
\end{frame}

%=============================================================================
% SECTION 6: FORECASTING
%=============================================================================
\section{Prognoza cu SARIMA}

\begin{frame}{Prognoze punctuale}
    \begin{block}{Calculul prognozei}
        Prognozele SARIMA sunt calculate recursiv:
        \begin{itemize}
            \item Inlocuiti $\varepsilon_{T+h}$ viitor cu 0
            \item Inlocuiti $Y_{T+h}$ viitor cu prognozele $\hat{Y}_{T+h|T}$
            \item Folositi valorile trecute cunoscute $Y_T, Y_{T-1}, \ldots$
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{exampleblock}{Tiparul sezonier in prognoze}
        Prognozele SARIMA capteaza in mod natural sezonalitatea:
        \begin{itemize}
            \item Pe termen scurt: influentate de valorile recente
            \item Pe termen lung: revin la tiparul sezonier
        \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Intervale de prognoza}
    \begin{block}{Cuantificarea incertitudinii}
        Interval de predictie $(1-\alpha)$\%:
        $$\hat{Y}_{T+h|T} \pm z_{\alpha/2} \sqrt{\Var(e_{T+h})}$$

        Varianta calculata din reprezentarea MA($\infty$).
    \end{block}

    \vspace{0.1cm}

    \begin{alertblock}{Proprietati cheie}
        \begin{itemize}
            \item Intervalele se largesc cu orizontul de prognoza
            \item Pentru serii $I(1,1)_s$: intervalele cresc nelimitat
            \item Tiparul sezonier vizibil in prognozele punctuale
            \item Incertitudinea capteaza atat variatia de trend cat si cea sezoniera
        \end{itemize}
    \end{alertblock}
\end{frame}

\begin{frame}{Prognoze pe orizont lung}
    \begin{block}{Comportamentul cand $h \to \infty$}
        \begin{itemize}
            \item Prognozele punctuale converg la tiparul sezonier determinist
            \item Daca exista deriva: trend linear + tipar sezonier
            \item Intervalele de prognoza continua sa se largeasca
        \end{itemize}
    \end{block}

    \vspace{0.1cm}

    \begin{exampleblock}{Implicatie practica}
        \begin{itemize}
            \item Pe termen scurt: SARIMA capteaza atat nivelul cat si sezonul
            \item Pe termen mediu: Prognoze sezoniere bune, incertitudine crescatoare
            \item Pe termen lung: Reflecta in principal tiparul sezonier, intervale largi
        \end{itemize}
    \end{exampleblock}
\end{frame}

%=============================================================================
% SECTION 7: REAL DATA APPLICATION
%=============================================================================
\section{Aplicatie pe date reale: Pasageri companiilor aeriene}

\begin{frame}{Datele privind pasagerii companiilor aeriene}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.75\textwidth, height=0.55\textheight, keepaspectratio]{charts/ch4_airline_data.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\small
    \begin{itemize}
        \item Set de date clasic: Pasageri internationali lunari ai companiilor aeriene (1949-1960)
        \item Trend ascendent clar si amplitudine sezoniera crescatoare
    \end{itemize}
    }
\end{frame}

\begin{frame}{Descompunerea sezoniera}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.78\textwidth, height=0.6\textheight, keepaspectratio]{charts/ch4_decomposition.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item Trend: Crestere puternica ascendenta
        \item Sezonalitate: Varfuri de vara (calatorii de vacanta)
        \item Rezidual: Variatie aleatoare dupa eliminarea trendului si sezonului
    \end{itemize}
    }
\end{frame}

\begin{frame}{Analiza ACF/PACF}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.75\textwidth, height=0.58\textheight, keepaspectratio]{charts/ch4_acf_pacf.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item Dupa diferentierea $\Delta\Delta_{12}$: varfuri la lag-urile 1 si 12
        \item Sugereaza SARIMA$(0,1,1)\times(0,1,1)_{12}$ (Modelul Airline)
    \end{itemize}
    }
\end{frame}

\begin{frame}{Rezultatele prognozei SARIMA}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.78\textwidth, height=0.55\textheight, keepaspectratio]{charts/ch4_sarima_forecast.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\small
    \begin{itemize}
        \item SARIMA capteaza atat trendul cat si tiparul sezonier
        \item Prognozele prezinta varfuri si minime sezoniere corespunzatoare
    \end{itemize}
    }
\end{frame}

\begin{frame}{Diagnosticarea modelului}
    \vspace{-0.3cm}
    \begin{center}
        \includegraphics[width=0.72\textwidth, height=0.6\textheight, keepaspectratio]{charts/ch4_diagnostics.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{itemize}
        \item Reziduurile par aleatorii; ACF in limite la toate lag-urile
        \item Modelul capteaza adecvat structura sezoniera
    \end{itemize}
    }
\end{frame}

\begin{frame}{Implementare in Python}
    {\small
    \begin{block}{Ajustarea SARIMA in Python}
        \texttt{from statsmodels.tsa.statespace.sarimax import SARIMAX}

        \vspace{0.1cm}
        \texttt{model = SARIMAX(y, order=(0,1,1), seasonal\_order=(0,1,1,12))}

        \texttt{results = model.fit()}

        \texttt{forecast = results.get\_forecast(steps=24)}
    \end{block}

    \vspace{0.1cm}

    \begin{alertblock}{Nota}
        Exemple complete in Python cu comentarii sunt furnizate in caietele Jupyter.
    \end{alertblock}
    }
\end{frame}

%=============================================================================
% SECTION 8: SUMMARY
%=============================================================================
\section{Sumar}

\begin{frame}{Concluzii cheie}
    {\small
    \hfill\begin{minipage}{0.9\textwidth}
    \begin{block}{Puncte principale}
        \begin{enumerate}
            \item \textbf{Sezonalitatea} este comuna in datele economice si de afaceri
            \item \textbf{Diferentierea sezoniera} $(1-L^s)$ elimina sezonalitatea stocastica
            \item \textbf{SARIMA}$(p,d,q)\times(P,D,Q)_s$ extinde ARIMA pentru date sezoniere
            \item \textbf{Structura multiplicativa} capteaza interactiunile sezon-trend
            \item \textbf{ACF/PACF} prezinta tipare la ambele lag-uri obisnuite si sezoniere
            \item \textbf{Selectia modelului}: Folositi AIC/BIC sau algoritmi auto-SARIMA
        \end{enumerate}
    \end{block}

    \vspace{0.1cm}

    \begin{alertblock}{Pasii urmatori}
        Capitolul 5 va acoperi seriile de timp multivariate: modele VAR, cauzalitatea Granger si cointegrarea.
    \end{alertblock}
    \end{minipage}
    }
\end{frame}

%=============================================================================
% SECTION 9: QUIZ
%=============================================================================
\section{Quiz}

\begin{frame}{Intrebarea 1}
    \begin{alertblock}{Intrebare}
        Pentru date lunare cu sezonalitate anuala, care este perioada sezoniera $s$?
    \end{alertblock}

    \vspace{0.3cm}

    \begin{enumerate}[(A)]
        \item $s = 4$
        \item $s = 7$
        \item $s = 12$
        \item $s = 52$
    \end{enumerate}
\end{frame}

\begin{frame}{Intrebarea 1: Raspuns}
    \begin{exampleblock}{Raspuns corect: (C) $s = 12$ (12 luni pe an)}
        Perioade comune: Trimestrial=4, Lunar=12, Saptamanal=52, Zilnic=7, Orar=24
    \end{exampleblock}
    \vspace{0.2cm}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.55\textheight, keepaspectratio]{charts/ch4_quiz1_seasonal_periods.pdf}
    \end{center}
\end{frame}

\begin{frame}{Intrebarea 2}
    \begin{alertblock}{Intrebare}
        Ce face operatorul de diferenta sezoniera $(1 - L^{12})$ unei serii lunare?
    \end{alertblock}

    \vspace{0.3cm}

    \begin{enumerate}[(A)]
        \item Calculeaza $Y_t - Y_{t-1}$ (schimbarea luna-la-luna)
        \item Calculeaza $Y_t - Y_{t-12}$ (schimbarea an-la-an)
        \item Calculeaza media mobila pe 12 luni
        \item Elimina doar componenta de trend
    \end{enumerate}
\end{frame}

\begin{frame}{Intrebarea 2: Raspuns}
    \begin{exampleblock}{Raspuns corect: (B) Schimbarea an-la-an}
        $(1 - L^{12})Y_t = Y_t - Y_{t-12}$ elimina tiparul sezonier prin compararea acelorasi luni.
    \end{exampleblock}
    \vspace{0.2cm}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.55\textheight, keepaspectratio]{charts/ch4_quiz2_seasonal_diff.pdf}
    \end{center}
\end{frame}

\begin{frame}{Intrebarea 3}
    \begin{alertblock}{Intrebare}
        In notatia SARIMA$(1,1,1)\times(1,1,1)_{12}$, ce reprezinta partea $(1,1,1)_{12}$?
    \end{alertblock}

    \vspace{0.3cm}

    \begin{enumerate}[(A)]
        \item AR(1), o diferentiere, MA(1) la nivelul obisnuit
        \item AR sezonier(1), o diferentiere sezoniera, MA sezonier(1)
        \item 12 termeni AR, 12 diferente, 12 termeni MA
        \item Modelul are 12 parametri in total
    \end{enumerate}
\end{frame}

\begin{frame}{Intrebarea 3: Raspuns}
    \begin{exampleblock}{Raspuns corect: (B)}
        AR sezonier(1), o diferentiere sezoniera, MA sezonier(1)
    \end{exampleblock}

    \begin{block}{Descompunerea notatiei SARIMA}
        SARIMA$(p,d,q)\times(P,D,Q)_s$:

        \vspace{0.2cm}
        \begin{tabular}{ll}
            $(p,d,q)$ & Non-sezonier: AR($p$), $d$ diferente, MA($q$) \\
            $(P,D,Q)_s$ & Sezonier: SAR($P$), $D$ dif. sezoniere, SMA($Q$) \\
        \end{tabular}

        \vspace{0.3cm}
        Pentru $(1,1,1)\times(1,1,1)_{12}$:
        \begin{itemize}
            \item Non-sezonier: AR(1), o diferenta obisnuita, MA(1)
            \item Sezonier: SAR(1) la lag-ul 12, un $\Delta_{12}$, SMA(1) la lag-ul 12
        \end{itemize}
    \end{block}
\end{frame}

\begin{frame}{Intrebarea 4}
    \begin{alertblock}{Intrebare}
        ``Modelul Airline'' este SARIMA$(0,1,1)\times(0,1,1)_{12}$. Cati parametri trebuie estimati (excluzand varianta)?
    \end{alertblock}

    \vspace{0.3cm}

    \begin{enumerate}[(A)]
        \item 1
        \item 2
        \item 4
        \item 12
    \end{enumerate}
\end{frame}

\begin{frame}{Intrebarea 4: Raspuns}
    \begin{exampleblock}{Raspuns corect: (B)}
        2 parametri
    \end{exampleblock}

    \begin{block}{Structura modelului}
        SARIMA$(0,1,1)\times(0,1,1)_{12}$:
        $$(1-L)(1-L^{12})Y_t = (1 + \theta_1 L)(1 + \Theta_1 L^{12})\varepsilon_t$$

        Parametri:
        \begin{itemize}
            \item $\theta_1$: coeficient MA non-sezonier
            \item $\Theta_1$: coeficient MA sezonier
        \end{itemize}

        Total: \textbf{2 parametri} (plus $\sigma^2$)
    \end{block}

    {\footnotesize
    \begin{alertblock}{De ce ``Modelul Airline''?}
        Box \& Jenkins (1970) au folosit acest model pentru a prognoza pasagerii companiilor aeriene internationale. Este remarcabil de eficient pentru multe serii economice sezoniere!
    \end{alertblock}
    }
\end{frame}

\begin{frame}{Intrebarea 5}
    \begin{alertblock}{Intrebare}
        Observati varfuri ACF semnificative la lag-urile 12, 24 si 36 intr-o serie lunara. Ce sugereaza aceasta?
    \end{alertblock}

    \vspace{0.3cm}

    \begin{enumerate}[(A)]
        \item Seria are o radacina unitara
        \item Seria are sezonalitate anuala care necesita diferentiere sezoniera
        \item Seria urmeaza un proces AR(36)
        \item Seria este deja stationara
    \end{enumerate}
\end{frame}

\begin{frame}{Intrebarea 5: Raspuns}
    \begin{exampleblock}{Raspuns corect: (B) Necesita diferentiere sezoniera}
        Varfuri ACF la 12, 24, 36 = sezonalitate stocastica. Aplicati $(1 - L^{12})$ pentru a o elimina.
    \end{exampleblock}
    \vspace{0.2cm}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.55\textheight, keepaspectratio]{charts/ch4_quiz5_seasonal_acf.pdf}
    \end{center}
\end{frame}

\begin{frame}{Intrebarea 6}
    \begin{alertblock}{Intrebare}
        Dupa aplicarea $(1-L)(1-L^{12})$ unei serii lunare, ACF prezinta un varf semnificativ doar la lag-ul 1 si lag-ul 12. Ce model SARIMA este sugerat?
    \end{alertblock}

    \vspace{0.3cm}

    \begin{enumerate}[(A)]
        \item SARIMA$(1,1,0)\times(1,1,0)_{12}$
        \item SARIMA$(0,1,1)\times(0,1,1)_{12}$
        \item SARIMA$(1,1,1)\times(1,1,1)_{12}$
        \item SARIMA$(0,1,0)\times(0,1,0)_{12}$
    \end{enumerate}
\end{frame}

\begin{frame}{Intrebarea 6: Raspuns}
    \begin{exampleblock}{Raspuns corect: (B)}
        SARIMA$(0,1,1)\times(0,1,1)_{12}$ (Modelul Airline)
    \end{exampleblock}

    \begin{block}{Reguli de identificare ACF/PACF}
        Pentru procese MA, ACF \textbf{se opreste brusc} dupa lag-ul $q$:

        \vspace{0.2cm}
        \begin{tabular}{ll}
            \textbf{Tipar} & \textbf{Sugereaza} \\
            \hline
            Varf ACF doar la lag-ul 1 & MA(1) pentru partea non-sezoniera \\
            Varf ACF doar la lag-ul 12 & SMA(1) pentru partea sezoniera \\
        \end{tabular}

        \vspace{0.2cm}
        Combinat: MA(1) $\times$ SMA(1) = $(0,d,1)\times(0,D,1)_{12}$

        Cu $d=1$ si $D=1$ (deja diferentiata): $(0,1,1)\times(0,1,1)_{12}$
    \end{block}
\end{frame}

\begin{frame}{Referinte}
    \begin{thebibliography}{9}
        \bibitem{boxjenkins} Box, G.E.P., Jenkins, G.M., Reinsel, G.C., \& Ljung, G.M. (2015). \textit{Time Series Analysis: Forecasting and Control}. 5th ed. Wiley.

        \bibitem{hyndman} Hyndman, R.J. \& Athanasopoulos, G. (2021). \textit{Forecasting: Principles and Practice}. 3rd ed. OTexts.

        \bibitem{hamilton} Hamilton, J.D. (1994). \textit{Time Series Analysis}. Princeton University Press.

        \bibitem{brockwell} Brockwell, P.J. \& Davis, R.A. (2016). \textit{Introduction to Time Series and Forecasting}. 3rd ed. Springer.
    \end{thebibliography}
\end{frame}

\end{document}
