% Chapter 5: GARCH and Volatility
% Harvard-quality academic presentation
% Bachelor program, Bucharest University of Economic Studies

\documentclass[9pt, aspectratio=169, t]{beamer}
\input{preamble}
\subtitle{Chapter 5: GARCH and Volatility}

\begin{document}

% Title page (no header/footer)
{
\setbeamertemplate{headline}{}
\setbeamertemplate{footline}{}
\begin{frame}
    \titlepage
\end{frame}
}

%=============================================================================
% LEARNING OBJECTIVES
%=============================================================================
\section{Motivation}

\begin{frame}{Learning Objectives}
    \begin{cminipage}{0.95\textwidth}
\begin{block}{By the end of this chapter, you will be able to:}
\begin{enumerate}\setlength{\itemsep}{0pt}
    \item Understand \textbf{volatility clustering} and stylized facts of financial returns
    \item Estimate and interpret \textbf{ARCH} and \textbf{GARCH} models
    \item Apply asymmetric models (\textbf{EGARCH}, \textbf{GJR-GARCH}) for the leverage effect
    \item Perform model validation and selection
    \item Forecast volatility and calculate \textbf{Value at Risk (VaR)}
\end{enumerate}
\end{block}
\vspace{-0.1cm}
\begin{alertblock}{Practical Skills}
    \begin{itemize}\setlength{\itemsep}{0pt}
        \item Python implementation with the \texttt{arch} package
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Estimation, forecasting, and automatic diagnostics
            \end{itemize}
        \item Interpreting parameters and volatility persistence
        \item VaR calculation for risk management
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Backtesting and forecast validation
            \end{itemize}
    \end{itemize}
\end{alertblock}
    \end{cminipage}
\end{frame}

%=============================================================================
% TABLE OF CONTENTS
%=============================================================================
\begin{frame}{Outline}
    \vspace{-0.3cm}
    {\small
    \begin{columns}[T]
        \begin{column}{0.48\textwidth}
            \begin{block}{Foundations}
                \begin{itemize}\setlength{\itemsep}{3pt}
                    \item Motivation
                    \item Introduction to Volatility Modeling
                    \item The ARCH Model
                    \item The GARCH Model
                    \item Asymmetric GARCH Models
                    \item Model Selection and Diagnostics
                \end{itemize}
            \end{block}
        \end{column}
        \begin{column}{0.48\textwidth}
            \begin{exampleblock}{Applications}
                \begin{itemize}\setlength{\itemsep}{3pt}
                    \item Volatility Forecasting
                    \item Python Implementation
                    \item Case Study: S\&P 500
                    \item Case Study: Bitcoin
                    \item Summary and Quiz
                \end{itemize}
            \end{exampleblock}
        \end{column}
    \end{columns}
    }
\end{frame}

%=============================================================================
% SECTION 1: INTRODUCTION TO VOLATILITY
%=============================================================================
\section{Introduction to Volatility Modeling}

\begin{frame}{Volatility Clustering}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{itemize}\setlength{\itemsep}{0pt}
        \item High volatility periods are followed by high volatility; calm periods by calm periods
        \item This suggests that \textbf{conditional variance} is predictable
    \end{itemize}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_volatility_clustering.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_clustering}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_clustering}
\end{frame}

\begin{frame}{Why Model Volatility?}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Empirical Observations in Financial Series}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Financial returns exhibit \textbf{volatility clustering} --- periods of high volatility tend to be followed by periods of high volatility
            \item The distribution of returns has \textbf{fat tails} (leptokurtosis)
            \item Return correlation is nearly zero, but correlation of squares is significant
            \item Volatility responds \textbf{asymmetrically} to shocks (leverage effect)
        \end{itemize}
    \end{block}

    \vspace{0.3cm}

    \begin{alertblock}{Limitation of ARIMA Models}
        ARIMA models assume \textbf{constant variance} (homoskedasticity), which is not realistic for financial series!
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Example: Bitcoin -- Volatility Clustering}
    \begin{cminipage}{0.95\textwidth}
    {\small
    \begin{block}{Observations}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Bitcoin daily returns (2019--2025): extremely pronounced volatility clustering
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Returns of $\pm 20\%$ during crisis periods (COVID, Terra/Luna)
                \end{itemize}
            \item Bitcoin volatility is significantly higher than traditional assets
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Typical $\alpha \approx 0.10$--$0.20$ (fast reaction to news)
                \end{itemize}
        \end{itemize}
    \end{block}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{Example: Bitcoin -- Volatility Clustering}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{btc_returns.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_btc\_returns}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_btc_returns}
\end{frame}

\begin{frame}{Stylized Facts of Financial Returns}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{block}{Observed Properties}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item \textbf{No autocorrelation} in returns
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item $\text{Corr}(r_t, r_{t-k}) \approx 0$ --- returns are unpredictable
                    \end{itemize}
                \item \textbf{Autocorrelation} in $r_t^2$, $|r_t|$
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item $\text{Corr}(r_t^2, r_{t-k}^2) > 0$ --- volatility is predictable
                    \end{itemize}
                \item \textbf{Fat tails} (kurtosis $> 3$)
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item More extreme values than the normal distribution predicts
                    \end{itemize}
                \item \textbf{Leverage effect}
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item Negative shocks increase volatility more than positive shocks
                    \end{itemize}
                \item \textbf{Volatility clustering}
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item As discussed above, conditional variance is predictable and persistent
                    \end{itemize}
            \end{itemize}
        \end{block}
    }
\end{frame}

\begin{frame}{Stylized Facts of Financial Returns}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_stylized_facts.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_stylized}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_stylized}
\end{frame}

\begin{frame}{Example: Bitcoin -- Evidence for ARCH Effects}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item ACF($r_t^2$) is significant at many lags $\Rightarrow$ \textbf{ARCH effects present}
            \item Conditional variance is predictable $\Rightarrow$ GARCH models are justified
        \end{itemize}
    \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.55\textheight, keepaspectratio]{btc_acf_squared.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_btc\_arch}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_btc_arch}
\end{frame}

\begin{frame}{Conditional Heteroskedasticity}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{defn}[Conditional Variance]
        For return series $\{r_t\}$, the \textbf{conditional variance} at time $t$ is:
        $\sigma_t^2 = \Var(r_t | \mathcal{F}_{t-1}) = \E[(r_t - \mu_t)^2 | \mathcal{F}_{t-1}]$
        where $\mathcal{F}_{t-1}$ is the information available up to time $t-1$.
    \end{defn}

    \vspace{0.3cm}

    \begin{block}{General Model}
        $r_t = \mu_t + \varepsilon_t$, \quad $\varepsilon_t = \sigma_t z_t$, \quad $z_t \sim \text{i.i.d.}(0, 1)$
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $\mu_t$ = conditional mean (ARMA); \quad $\sigma_t^2$ = conditional variance (GARCH)
            \item $z_t$ = standardized innovations (Normal, Student-t, GED)
        \end{itemize}
    \end{block}
    \end{cminipage}
\end{frame}

%=============================================================================
% SECTION 2: ARCH MODEL
%=============================================================================
\section{The ARCH Model}

\begin{frame}{Researcher Spotlight: Engle \& Bollerslev}
    \vspace{-0.2cm}
    \begin{columns}[T]
        \begin{column}{0.22\textwidth}
            \centering
            \includegraphics[width=0.95\textwidth, height=0.22\textheight, keepaspectratio]{photo_robert_engle.jpg}
            \\[0.05cm]
            {\tiny\textcolor{MediumGray}{Robert Engle (*1942)}}\\[-0.05cm]
            {\tiny\textcolor{MediumGray}{Nobel Prize 2003}}\\[0.02cm]
            \href{https://en.wikipedia.org/wiki/Robert_F._Engle}{\faWikipediaW\ \textcolor{MainBlue}{\tiny Wikipedia}}
        \end{column}
        \begin{column}{0.76\textwidth}
            \begin{block}{Biography}
                {\footnotesize \begin{itemize}\setlength{\itemsep}{0pt}
                    \item \textbf{Robert Engle}: American economist at NYU Stern. Nobel Prize (2003) ``for methods of analyzing economic time series with time-varying volatility (ARCH)''
                    \item \textbf{Tim Bollerslev}: Danish-American economist at Duke University, PhD student of Engle
                \end{itemize}}
            \end{block}
        \end{column}
    \end{columns}
    \vspace{0.1cm}
    \begin{columns}[T]
        \begin{column}{0.22\textwidth}
            \centering
            \includegraphics[width=0.95\textwidth, height=0.22\textheight, keepaspectratio]{photo_tim_bollerslev.jpg}
            \\[0.05cm]
            {\tiny\textcolor{MediumGray}{Tim Bollerslev (*1958)}}\\[0.02cm]
            \href{https://en.wikipedia.org/wiki/Tim_Bollerslev}{\faWikipediaW\ \textcolor{MainBlue}{\tiny Wikipedia}}
        \end{column}
        \begin{column}{0.76\textwidth}
            \begin{exampleblock}{Key Contributions}
                {\footnotesize
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item \textbf{ARCH model} (Engle, 1982) --- autoregressive conditional heteroskedasticity
                    \item \textbf{GARCH model} (Bollerslev, 1986) --- generalized ARCH with persistent volatility
                    \item \textbf{Realized volatility} measures and high-frequency econometrics
                    \item Foundation for modern financial risk management (VaR, ES)
                \end{itemize}}
            \end{exampleblock}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{ARCH(1) Simulation: Effect of $\alpha$ Parameter}
    \vspace{-0.2cm}
    {\small
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Higher $\alpha$ means volatility reacts more strongly to recent shocks
        \end{itemize}
    \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.58\textheight, keepaspectratio]{garch_arch1_simulation.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_arch\_sim}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_arch_sim}
\end{frame}

\begin{frame}{The ARCH(q) Model --- Engle (1982)}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{defn}[ARCH(q)]
        The \textbf{Autoregressive Conditional Heteroskedasticity} model of order $q$:
        \[
            \varepsilon_t = \sigma_t z_t, \quad z_t \sim \text{i.i.d.}(0, 1), \quad
            \sigma_t^2 = \omega + \sum_{i=1}^{q} \alpha_i \varepsilon_{t-i}^2
        \]
    \end{defn}

    \vspace{0.2cm}

    \begin{block}{Stationarity Restrictions}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $\omega > 0$ (positive base variance), \quad $\alpha_i \geq 0$ (non-negativity)
            \item $\sum_{i=1}^{q} \alpha_i < 1$ (stationarity)
        \end{itemize}
    \end{block}

    \end{cminipage}
\end{frame}

\begin{frame}{Properties of the ARCH(1) Model}
    \begin{cminipage}{0.95\textwidth}
    \begin{block}{ARCH(1): $\sigma_t^2 = \omega + \alpha_1 \varepsilon_{t-1}^2$}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Unconditional variance}: $\E[\varepsilon_t^2] = \dfrac{\omega}{1 - \alpha_1}$ (if $\alpha_1 < 1$)
            \item \textbf{Kurtosis}: $\kappa = 3 \cdot \dfrac{1 - \alpha_1^2}{1 - 3\alpha_1^2}$ (if $\alpha_1^2 < 1/3$)
            \item Kurtosis $> 3$ for $\alpha_1 > 0$ $\Rightarrow$ \textbf{fat tails}!
        \end{itemize}
    \end{block}

    \vspace{0.3cm}

    \begin{exampleblock}{Numerical Example}
        If $\omega = 0.0001$ and $\alpha_1 = 0.3$:
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Unconditional variance: $\sigma^2 = \frac{0.0001}{1 - 0.3} = 0.000143$
            \item Kurtosis: $\kappa = 3 \cdot \frac{1 - 0.09}{1 - 0.27} = 3.74 > 3$
        \end{itemize}
    \end{exampleblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Derivation: Unconditional Variance of ARCH(1)}
    \begin{cminipage}{0.95\textwidth}
    \begin{proof}[Derivation]
        Let $\varepsilon_t = \sigma_t z_t$ with $z_t \sim N(0,1)$ and $\sigma_t^2 = \omega + \alpha_1 \varepsilon_{t-1}^2$.

        \vspace{0.2cm}
        \textbf{Step 1}: Take unconditional expectation:
        \[
            \E[\varepsilon_t^2] = \E[\sigma_t^2 z_t^2] = \E[\sigma_t^2] \cdot \E[z_t^2] = \E[\sigma_t^2] \quad \text{(independence: $\sigma_t^2$ is $\mathcal{F}_{t-1}$-measurable, $z_t \perp \mathcal{F}_{t-1}$)}
        \]

        \textbf{Step 2}: Apply expectation to variance equation:
        \[
            \E[\sigma_t^2] = \E[\omega + \alpha_1 \varepsilon_{t-1}^2] = \omega + \alpha_1 \E[\varepsilon_{t-1}^2]
        \]

        \textbf{Step 3}: By stationarity, $\E[\varepsilon_t^2] = \E[\varepsilon_{t-1}^2] = \sigma^2$:
        \[
            \sigma^2 = \omega + \alpha_1 \sigma^2 \quad \Rightarrow \quad \sigma^2 (1 - \alpha_1) = \omega
        \]

        \textbf{Result}: $\boxed{\sigma^2 = \dfrac{\omega}{1 - \alpha_1}}$ \quad (requires $\alpha_1 < 1$ for stationarity)
    \end{proof}
    \end{cminipage}
\end{frame}

\begin{frame}{Derivation: Kurtosis of ARCH(1)}
    \begin{cminipage}{0.95\textwidth}
    {\small
    For $\varepsilon_t = \sigma_t z_t$ with $z_t \sim N(0,1)$:

    \textbf{Step 1}: $\E[\varepsilon_t^4] = \E[\sigma_t^4] \cdot \E[z_t^4] = 3 \E[\sigma_t^4]$ \quad (since $\E[z^4] = 3$)

    \textbf{Step 2}: Using $\sigma_t^2 = \omega + \alpha_1 \varepsilon_{t-1}^2$:
    \[
        \E[\sigma_t^4] = \E[(\omega + \alpha_1 \varepsilon_{t-1}^2)^2] = \omega^2 + 2\omega\alpha_1 \sigma^2 + \alpha_1^2 \E[\varepsilon_{t-1}^4]
    \]

    \textbf{Step 3}: Solving the recursion yields:
    \[
        \boxed{\kappa = \frac{\E[\varepsilon_t^4]}{(\E[\varepsilon_t^2])^2} = 3 \cdot \frac{1 - \alpha_1^2}{1 - 3\alpha_1^2}}
    \]
    }

    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $\kappa > 3$ for any $\alpha_1 > 0$ $\Rightarrow$ \textbf{fat tails} (leptokurtosis)
            \item Requires $\alpha_1 < 0.577$ for finite fourth moment
            \item ARCH naturally generates heavy-tailed distributions!
        \end{itemize}
    \end{block}
    \end{cminipage}
\end{frame}

\begin{frame}{Theory vs Empirics: The Kurtosis Gap}
    \begin{cminipage}{0.95\textwidth}
    \small
    \vspace{-0.2cm}
    \begin{block}{ARCH(1) Kurtosis: Too Low!}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item For typical stock returns: $\alpha_1 \approx 0.09$ (S\&P 500)
            \item Theoretical kurtosis: $\kappa = 3 \cdot \frac{1 - 0.09^2}{1 - 3 \times 0.09^2} \approx \textbf{3.05}$
            \item Empirical kurtosis of S\&P 500 daily returns: $\kappa \approx \textbf{13.8}$
        \end{itemize}
    \end{block}
    \vspace{-0.1cm}
    \begin{alertblock}{The Kurtosis Gap}
        \begin{center}
        {\large $\underbrace{3.05}_{\text{ARCH(1)-Normal}} \;\ll\; \underbrace{13.8}_{\text{Empirical}}$}
        \end{center}
        \vspace{-2mm}
        ARCH(1) with Gaussian innovations cannot match the extreme kurtosis observed in financial data.
    \end{alertblock}
    \vspace{-0.1cm}
    \begin{exampleblock}{Solutions}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Student-$t$ innovations}: $z_t \sim t_\nu$ adds kurtosis from the distribution itself
            \item \textbf{GARCH(1,1)}: persistence ($\beta > 0$) generates additional kurtosis
            \item Both combined: Student-$t$ GARCH captures $\kappa \gg 3$ observed in practice
        \end{itemize}
    \end{exampleblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Testing for ARCH Effects}
    \begin{cminipage}{0.95\textwidth}
    \begin{block}{Engle's Test for ARCH Effects}
        \textbf{Procedure}:
        \begin{enumerate}\setlength{\itemsep}{0pt}
            \item Estimate the mean model and obtain residuals $\hat{\varepsilon}_t$
            \item Calculate $\hat{\varepsilon}_t^2$
            \item Regress $\hat{\varepsilon}_t^2$ on its lags:
            \[
                \hat{\varepsilon}_t^2 = \beta_0 + \beta_1 \hat{\varepsilon}_{t-1}^2 + \cdots + \beta_q \hat{\varepsilon}_{t-q}^2 + u_t
            \]
            \item Calculate the statistic $LM = T \cdot R^2 \sim \chi^2(q)$
        \end{enumerate}
    \end{block}

    \vspace{0.3cm}

    \begin{alertblock}{Hypotheses}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $H_0$: No ARCH effects ($\alpha_1 = \cdots = \alpha_q = 0$)
            \item $H_1$: ARCH effects present (at least one $\alpha_i \neq 0$)
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Limitations of the ARCH Model}
    \begin{cminipage}{0.95\textwidth}
    \begin{alertblock}{Practical Problems}
        \begin{enumerate}\setlength{\itemsep}{0pt}
            \item \textbf{High order} --- many lags are usually needed (large $q$)
            \item \textbf{Many parameters} --- estimation difficulties
            \item \textbf{Non-negativity constraints} --- difficult to impose for large $q$
            \item \textbf{Does not capture persistence} --- observed volatility is very persistent
        \end{enumerate}
    \end{alertblock}

    \vspace{0.5cm}

    \begin{block}{The Solution}
        \textbf{The GARCH Model} --- introduces lags of conditional variance to capture persistence with fewer parameters!
    \end{block}
    \end{cminipage}
\end{frame}

%=============================================================================
% SECTION 3: GARCH MODEL
%=============================================================================
\section{The GARCH Model}

\begin{frame}{The GARCH(1,1) Model}
    \vspace{-0.2cm}
    \begin{cminipage}{0.95\textwidth}
    {\small
        \begin{block}{The Most Popular Volatility Model}
            $\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2$
        \end{block}

        \vspace{0.2cm}

        \begin{block}{Restrictions \& Properties}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item $\omega > 0$, $\alpha \geq 0$, $\beta \geq 0$; \quad $\alpha + \beta < 1$ (stationarity)
                \item $\bar{\sigma}^2 = \frac{\omega}{1 - \alpha - \beta}$; \quad Half-life: $HL = \frac{\ln(0.5)}{\ln(\alpha + \beta)}$
            \end{itemize}
        \end{block}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{The GARCH(1,1) Model}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_conditional_variance.pdf}
    \end{center}
\end{frame}

\begin{frame}{The GARCH(p,q) Model --- Bollerslev (1986)}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{defn}[GARCH(p,q)]
        The \textbf{Generalized ARCH} model:
        \[
            \varepsilon_t = \sigma_t z_t, \quad z_t \sim \text{i.i.d.}(0, 1)
        \]
        \[
            \sigma_t^2 = \omega + \sum_{i=1}^{q} \alpha_i \varepsilon_{t-i}^2 + \sum_{j=1}^{p} \beta_j \sigma_{t-j}^2
        \]
    \end{defn}

    \vspace{0.3cm}

    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $\omega$ = base level of volatility
            \item $\alpha_i$ = reaction to recent shocks (news coefficients)
            \item $\beta_j$ = volatility persistence (memory)
            \item $\alpha + \beta$ = total persistence
        \end{itemize}
    \end{block}
    \end{cminipage}
\end{frame}

\begin{frame}{GARCH(1,1) Simulation: Persistence Effect}
    \vspace{-0.2cm}
    {\footnotesize
        \begin{block}{Interpretation}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item $\alpha$ controls reaction to shocks
                \item $\beta$ controls persistence
                \item The sum $\alpha + \beta$ determines mean-reversion speed
            \end{itemize}
        \end{block}
        }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_garch11_simulation.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_garch\_sim}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_garch_sim}
\end{frame}

\begin{frame}{Derivation: Unconditional Variance of GARCH(1,1)}
\small
    \begin{proof}[Derivation]
        For $\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2$:

        \textbf{Step 1}: Take unconditional expectation:
        $\E[\sigma_t^2] = \omega + \alpha \E[\varepsilon_{t-1}^2] + \beta \E[\sigma_{t-1}^2]$

        \textbf{Step 2}: By stationarity, $\E[\sigma_t^2] = \E[\sigma_{t-1}^2] = \bar{\sigma}^2$ and $\E[\varepsilon_t^2] = \bar{\sigma}^2$:
        $\bar{\sigma}^2 = \omega + (\alpha + \beta) \bar{\sigma}^2$

        \textbf{Step 3}: Solve: $\bar{\sigma}^2 (1 - \alpha - \beta) = \omega \Rightarrow \boxed{\bar{\sigma}^2 = \frac{\omega}{1 - \alpha - \beta}}$
    \end{proof}
    \vspace{-0.1cm}
    \begin{alertblock}{Stationarity Condition}
        Requires $\alpha + \beta < 1$ for finite unconditional variance.
    \end{alertblock}
\end{frame}

\begin{frame}{GARCH(1,1) as ARMA for $\varepsilon_t^2$}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{block}{ARMA(1,1) Representation}
        Define $\nu_t = \varepsilon_t^2 - \sigma_t^2$ (variance shock). Then:
        \[
            \varepsilon_t^2 = \omega + (\alpha + \beta) \varepsilon_{t-1}^2 + \nu_t - \beta \nu_{t-1}
        \]

        This is an \textbf{ARMA(1,1)} for $\varepsilon_t^2$!
    \end{block}

    \vspace{0.3cm}

    \begin{exampleblock}{Implications}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item ACF of $\varepsilon_t^2$ decays exponentially (like ARMA)
            \item Persistence is given by $\alpha + \beta$
            \item PACF can help identify the order
        \end{itemize}
    \end{exampleblock}
    }
\end{frame}

\begin{frame}{Derivation: ARMA Representation of GARCH(1,1)}
    \begin{proof}[Derivation]
        \textbf{Step 1}: Define variance shock: $\nu_t = \varepsilon_t^2 - \sigma_t^2$
        \begin{itemize}
            \item $\E[\nu_t | \mathcal{F}_{t-1}] = \E[\varepsilon_t^2 | \mathcal{F}_{t-1}] - \sigma_t^2 = \sigma_t^2 - \sigma_t^2 = 0$
            \item $\nu_t$ is a martingale difference sequence
        \end{itemize}

        \vspace{0.2cm}
        \textbf{Step 2}: Substitute $\sigma_t^2 = \varepsilon_t^2 - \nu_t$ into GARCH equation:
        \[
            \varepsilon_t^2 - \nu_t = \omega + \alpha \varepsilon_{t-1}^2 + \beta (\varepsilon_{t-1}^2 - \nu_{t-1})
        \]

        \textbf{Step 3}: Rearrange:
        \[
            \varepsilon_t^2 = \omega + (\alpha + \beta) \varepsilon_{t-1}^2 + \nu_t - \beta \nu_{t-1}
        \]

        \textbf{Result}: ARMA(1,1) with AR coefficient $\phi = \alpha + \beta$ and MA coefficient $\theta = -\beta$.
    \end{proof}
\end{frame}

\begin{frame}{Derivation: Volatility Persistence and Half-Life}
    \begin{cminipage}{0.95\textwidth}
\small
    \begin{block}{Multi-Step Forecast GARCH(1,1)}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $\E_t[\sigma_{t+h}^2] = \bar{\sigma}^2 + (\alpha+\beta)^{h-1}(\sigma_{t+1}^2 - \bar{\sigma}^2)$
        \end{itemize}
    \end{block}
    \vspace{-0.1cm}
    \begin{block}{Derivation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Step 1}: Let $\phi = \alpha + \beta$ and $q_t = \sigma_t^2 - \bar{\sigma}^2$ (deviation from mean)
            \item \textbf{Step 2}: From the GARCH equation: $\E_t[q_{t+1}] = \phi \cdot q_t$, so $\E_t[q_{t+h}] = \phi^h \cdot q_t$
            \item \textbf{Step 3}: Half-life = time until deviation halves:
            $\phi^{HL} = 0.5 \;\Rightarrow\; HL = \frac{\ln(0.5)}{\ln(\phi)} = \frac{-0.693}{\ln(\alpha+\beta)}$
        \end{itemize}
    \end{block}
    \vspace{-0.1cm}
    \begin{exampleblock}{Example: S\&P 500}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item With $\alpha + \beta = 0.988$: $HL = \frac{-0.693}{-0.012} \approx \textbf{58 days}$ (shocks persist $\sim$3 months!)
        \end{itemize}
    \end{exampleblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Estimation of GARCH Models}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Maximum Likelihood Estimation (MLE)}
        Log-likelihood (normal): $\ell(\theta) = -\frac{T}{2} \ln(2\pi) - \frac{1}{2} \sum_{t=1}^{T} \left[ \ln(\sigma_t^2) + \frac{\varepsilon_t^2}{\sigma_t^2} \right]$
    \end{block}

    \vspace{0.2cm}

    \begin{block}{Alternative Distributions for $z_t$}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Student-t}: captures fat tails --- most common choice
            \item \textbf{GED}: flexibility for kurtosis
            \item \textbf{Skewed Student-t}: asymmetry and fat tails
        \end{itemize}
    \end{block}

    \vspace{0.2cm}

    \begin{alertblock}{Practical Note}
        Student-t distribution typically provides better fit for financial returns due to fat tails (kurtosis $> 3$).
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Quasi-MLE and Robustness}
    \begin{cminipage}{0.95\textwidth}
    \scriptsize
    \setlength{\abovedisplayskip}{2pt}\setlength{\belowdisplayskip}{2pt}
    \vspace{-0.2cm}
    \begin{block}{What if the Distribution is Misspecified?}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Standard MLE assumes $z_t \sim N(0,1)$, but true distribution may differ
            \item \textbf{Quasi-MLE (QMLE)}: maximize the Gaussian log-likelihood even if $z_t$ is non-normal
            \item Key insight: we only need the \textit{first two conditional moments} to be correct
        \end{itemize}
    \end{block}
    \vspace{-0.15cm}
    \begin{defn}[QMLE Consistency --- Weiss (1986); Lee \& Hansen (1994)]
        If the conditional mean and variance are correctly specified, QMLE is \textbf{consistent} for $(\omega, \alpha, \beta)$ regardless of the true distribution of $z_t$. Robust (sandwich) standard errors: Bollerslev \& Wooldridge (1992).
    \end{defn}
    \vspace{-0.15cm}
    \begin{alertblock}{Sandwich (Robust) Standard Errors}
        Standard errors must be corrected:
        \[
            \hat{V}_{\text{robust}} = \hat{A}^{-1} \hat{B} \hat{A}^{-1} \quad \text{(White, 1982)}
        \]
        where $\hat{A}$ = Hessian, $\hat{B}$ = outer product of scores. In Python: \texttt{result.summary()} reports robust SEs by default.
    \end{alertblock}
    \vspace{-0.15cm}
    \begin{exampleblock}{When to Use QMLE vs Full MLE}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{QMLE}: robust default --- consistent even under misspecification
            \item \textbf{Full MLE} (Student-$t$): more \textit{efficient} if the distribution is correct
        \end{itemize}
    \end{exampleblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Practical Estimation Challenges}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Common Issues}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Convergence failure}: Log-likelihood is non-convex; optimizer may get stuck
            \item \textbf{Boundary solutions}: $\hat{\alpha} \approx 0$ or $\hat{\alpha} + \hat{\beta} \approx 1$ (near-IGARCH)
            \item \textbf{Sensitivity to starting values}: Different initializations $\Rightarrow$ different estimates
        \end{itemize}
    \end{block}
    \vspace{-0.1cm}
    \begin{exampleblock}{Best Practices}
        \begin{enumerate}\setlength{\itemsep}{0pt}
            \item Try multiple optimizers: \textbf{BFGS} (fast, gradient-based) vs \textbf{Nelder-Mead} (derivative-free)
            \item Initialize $\sigma_0^2$ with sample variance (backcast)
            \item Check $\alpha + \beta < 1$ post-estimation; if $\approx 1$, consider IGARCH or regime-switching
            \item Compare results across starting values; consistent estimates $\Rightarrow$ reliable model
        \end{enumerate}
    \end{exampleblock}
    \vspace{-0.1cm}
    \begin{alertblock}{Rule of Thumb}
        If BFGS and Nelder-Mead give \textit{different} parameter estimates, the model may be misspecified or the data insufficient.
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Typical Values for GARCH(1,1)}
    \begin{cminipage}{0.95\textwidth}
    \begin{center}
        \begin{tabular}{lccc}
            \toprule
            \textbf{Series} & $\bm{\alpha}$ & $\bm{\beta}$ & $\bm{\alpha + \beta}$ \\
            \midrule
            S\&P 500 daily & 0.05--0.10 & 0.85--0.95 & 0.95--0.99 \\
            EUR/USD daily & 0.03--0.08 & 0.90--0.95 & 0.95--0.99 \\
            Bitcoin daily & 0.10--0.20 & 0.75--0.85 & 0.90--0.98 \\
            Bonds & 0.02--0.05 & 0.90--0.97 & 0.95--0.99 \\
            \bottomrule
        \end{tabular}
    \end{center}

    \vspace{0.5cm}

    \begin{alertblock}{Observations}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $\alpha + \beta$ close to 1 $\Rightarrow$ \textbf{very persistent volatility}
            \item Small $\alpha$, large $\beta$ $\Rightarrow$ slow reaction to shocks, long memory
            \item Bitcoin: larger $\alpha$ $\Rightarrow$ faster reaction to news
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{GARCH vs IGARCH: Persistence Comparison}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Standard GARCH reverts to unconditional mean
            \item IGARCH has no finite mean $\Rightarrow$ shocks persist indefinitely
        \end{itemize}
    \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_igarch_comparison.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_igarch}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_igarch}
\end{frame}

\begin{frame}{IGARCH --- Integrated GARCH}
    \quantlet{TSA\_ch5\_igarch}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_igarch}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{defn}[IGARCH(1,1)]
        When $\alpha + \beta = 1$:
        \[
            \sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + (1 - \alpha) \sigma_{t-1}^2
        \]
    \end{defn}

    \vspace{0.3cm}

    \begin{block}{Properties}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Unconditional variance does not exist (infinite) (but the process remains strictly stationary, cf.\ Nelson, 1990)
            \item Shocks have \textbf{permanent} effect on volatility
            \item Used for series with extreme persistence
            \item Useful for \textbf{RiskMetrics} (J.P. Morgan): $\alpha = 0.06$, $\beta = 0.94$
        \end{itemize}
    \end{block}

    \begin{rmk}
        IGARCH is analogous to a unit root in variance!
    \end{rmk}
    \end{cminipage}
\end{frame}

\begin{frame}{Volatility Regime Changes}
    \begin{cminipage}{0.95\textwidth}
    \scriptsize
    \setlength{\abovedisplayskip}{2pt}\setlength{\belowdisplayskip}{2pt}
    \vspace{-0.3cm}
    \begin{block}{Problem}
        GARCH assumes a \textbf{single regime} with constant parameters. But volatility often exhibits \textbf{structural breaks} (e.g., 2008 crisis, COVID-19).
    \end{block}
    \vspace{-0.2cm}
    \begin{defn}[Markov-Switching GARCH]
        Parameters $(\omega, \alpha, \beta)$ switch between $K$ regimes governed by a hidden Markov chain:
        \[
            \sigma_t^2 = \omega_{s_t} + \alpha_{s_t} \varepsilon_{t-1}^2 + \beta_{s_t} \sigma_{t-1}^2, \quad s_t \in \{1, \ldots, K\}
        \]
    \end{defn}
    \vspace{-0.2cm}
    \begin{exampleblock}{Inclan-Tiao ICSS Test}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Detects \textbf{multiple change points} in unconditional variance
            \item Based on cumulative sum of squared observations (CUSUM-type)
            \item Typical findings: S\&P 500 shows breaks at 2001, 2008, 2020
        \end{itemize}
    \end{exampleblock}
    \vspace{-0.2cm}
    \begin{alertblock}{Practical Implications}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item If structural breaks present, GARCH persistence ($\alpha + \beta$) is \textbf{upward biased} $\Rightarrow$ spurious IGARCH
            \item Solution: estimate GARCH separately per regime, or use rolling windows
            \item Alternative: Markov-switching GARCH with $K=2$ (low-vol / high-vol regimes)
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

%=============================================================================
% SECTION 4: ASYMMETRIC GARCH MODELS
%=============================================================================
\section{Asymmetric GARCH Models}

\begin{frame}{Leverage Effect}
    \begin{cminipage}{0.95\textwidth}
    {\scriptsize
        \begin{block}{Definition}
            \textbf{Leverage effect}: Negative shocks increase volatility \textbf{more} than positive shocks of the same magnitude.
        \end{block}
        \begin{alertblock}{Problem with GARCH}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Standard GARCH: $\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2$ --- only $\varepsilon_{t-1}^2$ matters, sign is lost!
                \item Economic intuition: Bad news $\Rightarrow$ stock price falls $\Rightarrow$ debt/equity ratio rises $\Rightarrow$ volatility increases
            \end{itemize}
        \end{alertblock}
        \begin{exampleblock}{Empirical Evidence}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Black (1976): first documentation of the leverage effect in equity markets
                \item The effect is asymmetric: 5\% drops increase volatility more than 5\% rises
                \item Solutions: EGARCH, GJR-GARCH, TGARCH --- models that distinguish the sign of shocks
            \end{itemize}
        \end{exampleblock}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{Leverage Effect}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_leverage_effect.pdf}
    \end{center}
\end{frame}

\begin{frame}{EGARCH Simulation: Symmetric vs Asymmetric}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item When $\gamma < 0$, negative shocks increase volatility more than positive shocks
        \end{itemize}
    \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_egarch_simulation.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_egarch\_sim}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_egarch_sim}
\end{frame}

\begin{frame}{The EGARCH Model --- Nelson (1991)}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.3cm}
    {\footnotesize
    \begin{defn}[EGARCH(1,1)]
        \textbf{Exponential GARCH}:
        \[
            \ln(\sigma_t^2) = \omega + \alpha \left( |z_{t-1}| - \E[|z_{t-1}|] \right) + \gamma z_{t-1} + \beta \ln(\sigma_{t-1}^2)
        \]
        where $z_t = \varepsilon_t / \sigma_t$.
    \end{defn}

    \vspace{0.3cm}

    \begin{block}{EGARCH Advantages}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{No non-negativity constraints required} --- models $\ln(\sigma_t^2)$
            \item \textbf{Captures leverage effect} through parameter $\gamma$
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item $\gamma < 0$: negative shocks $\Rightarrow$ higher volatility
                \item $\gamma = 0$: symmetric effect (like GARCH)
            \end{itemize}
            \item Persistence is given by $\beta$
        \end{itemize}
    \end{block}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{News Impact Curve --- EGARCH}
    \begin{cminipage}{0.95\textwidth}
    {\small
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{News Impact Curve}: relationship between $\varepsilon_t$ and $\sigma_{t+1}^2$
            \item \textbf{GARCH}: symmetric curve (parabola)
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Positive and negative shocks have the same impact
                \end{itemize}
            \item \textbf{EGARCH}: asymmetric curve
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Negative shocks have larger impact on volatility
                \end{itemize}
        \end{itemize}
    \end{block}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{News Impact Curve --- EGARCH}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_news_impact_curve.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_nic}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_nic}
\end{frame}

\begin{frame}{The GJR-GARCH Model}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.3cm}
    {\footnotesize
    \begin{defn}[GJR-GARCH(1,1)]
        Glosten, Jagannathan \& Runkle (1993):
        $\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \gamma \varepsilon_{t-1}^2 \cdot I_{t-1} + \beta \sigma_{t-1}^2$
        where $I_{t-1} = 1$ if $\varepsilon_{t-1} < 0$, else $0$.
    \end{defn}

    \vspace{0.2cm}

    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Positive shocks: impact = $\alpha$; \quad Negative shocks: impact = $\alpha + \gamma$
            \item Leverage effect present if $\gamma > 0$
            \item Stationarity: $\alpha + \gamma/2 + \beta < 1$
        \end{itemize}
    \end{block}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{GJR-GARCH/TGARCH Simulation}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item GJR-GARCH adds an indicator term to capture asymmetric response to negative shocks
        \end{itemize}
    \end{block}
    }
    \end{cminipage}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_gjr_simulation.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_gjr\_sim}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_gjr_sim}
\end{frame}

\begin{frame}{TGARCH --- Threshold GARCH}
    \begin{defn}[TGARCH(1,1)]
        Zakoian (1994) models standard deviation:
        $\sigma_t = \omega + \alpha^+ \varepsilon_{t-1}^+ + \alpha^- \varepsilon_{t-1}^- + \beta \sigma_{t-1}$
    \end{defn}

    \vspace{0.2cm}

    \begin{block}{Comparison of Asymmetric Models}
        \begin{center}
            \small
            \begin{tabular}{lcc}
                \toprule
                \textbf{Model} & \textbf{Specification} & \textbf{Leverage} \\
                \midrule
                GARCH & $\sigma_t^2$ & No \\
                EGARCH & $\ln(\sigma_t^2)$ & Yes ($\gamma < 0$) \\
                GJR-GARCH & $\sigma_t^2$ with indicator & Yes ($\gamma > 0$) \\
                TGARCH & $\sigma_t$ & Yes ($\alpha^- > \alpha^+$) \\
                \bottomrule
            \end{tabular}
        \end{center}
    \end{block}
\end{frame}

\begin{frame}{TGARCH Simulation: Asymmetric Volatility Response}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item TGARCH with $\alpha^+ = 0.03$ and $\alpha^- = 0.15$ $\Rightarrow$ negative shocks amplify volatility by 5$\times$
            \item Volatility bands $\pm 2\sigma$ widen asymmetrically during crisis periods
        \end{itemize}
    \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_tgarch_simulation.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_tgarch\_sim}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_tgarch_sim}
\end{frame}

\begin{frame}{News Impact Curves Comparison}
    \vspace{-0.2cm}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_nic_comparison.pdf}
    \end{center}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Standard GARCH}: symmetric
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Treats positive and negative shocks identically
                \end{itemize}
            \item \textbf{EGARCH} and \textbf{GJR-GARCH}: capture asymmetry
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Leverage effect: negative shocks $\Rightarrow$ larger impact
                \end{itemize}
        \end{itemize}
    \end{block}
    }
    \quantlet{TSA\_ch5\_nic\_comp}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_nic_comp}
\end{frame}

\begin{frame}{GARCH Family Comparison}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item All models capture volatility clustering, but differ in how they model asymmetry
        \end{itemize}
    \end{block}
    }
    \end{cminipage}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_family_comparison.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_family}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_family}
\end{frame}

\begin{frame}{GARCH-in-Mean (GARCH-M) --- Engle, Lilien \& Robins (1987)}
    \vspace{-0.2cm}
\small
    \begin{defn}[GARCH-M]
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Model}: Volatility enters directly into the mean equation:
            \vspace{-0.2cm}
            \begin{align*}
                r_t &= \mu + \delta \cdot g(\sigma_t^2) + \varepsilon_t, \quad \varepsilon_t = \sigma_t z_t \\
                \sigma_t^2 &= \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2
            \end{align*}
            \vspace{-0.4cm}
            \item \textbf{Function $g$}: can be $\sigma_t^2$, $\sigma_t$, or $\ln(\sigma_t^2)$
        \end{itemize}
    \end{defn}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{block}{Economic Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $\delta > 0$: \textbf{risk premium} $\Rightarrow$ higher returns when volatility is high
            \item Formalizes the risk-return relationship (CAPM, Merton ICAPM); test $H_0: \delta = 0$
        \end{itemize}
    \end{block}
    \vspace{-0.1cm}
    \begin{exampleblock}{Typical Example: Equities}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $r_t = 0.02 + \underbrace{0.15}_{\delta} \cdot \sigma_t + \varepsilon_t$ \quad $\Rightarrow$ At $\sigma_t = 2\%$: $\E[r_t] = 0.023$ (0.3\% premium)
        \end{itemize}
    \end{exampleblock}
    }
\end{frame}

\begin{frame}{GARCH-M: Alternative Specifications}
\small
    \begin{block}{Common Specifications}
        Risk premium can enter in different forms: (1) $r_t = \mu + \lambda \sigma_t + \varepsilon_t$; (2) $r_t = \mu + \lambda \sigma_t^2 + \varepsilon_t$; (3) $r_t = \mu + \lambda \ln(\sigma_t^2) + \varepsilon_t$
    \end{block}
    \vspace{-0.1cm}
    \begin{exampleblock}{Typical Results for Equity Markets}
        \begin{itemize}
            \item Estimated $\lambda$ often positive but small (0.01--0.10)
            \item Significance varies across markets and periods
            \item Variance specification yields larger $\lambda$ estimates
        \end{itemize}
    \end{exampleblock}
    \vspace{-0.1cm}
    \begin{rmk}
        GARCH-M is used in asset pricing, portfolio optimization, and CAPM testing.
    \end{rmk}
\end{frame}

%=============================================================================
% SECTION 5: MODEL SELECTION AND DIAGNOSTICS
%=============================================================================
\section{Model Selection and Diagnostics}

\begin{frame}{Order Selection}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Information Criteria}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{AIC} = $-2\ell + 2k$
            \item \textbf{BIC} = $-2\ell + k \ln(T)$
            \item \textbf{HQIC} = $-2\ell + 2k \ln(\ln(T))$
        \end{itemize}
        where $\ell$ = maximized log-likelihood, $k$ = number of parameters.
    \end{block}

    \vspace{0.3cm}

    \begin{alertblock}{Practical Recommendations}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item GARCH(1,1) is sufficient in \textbf{90\% of cases}
            \item Check if asymmetric model significantly improves fit
            \item Choose innovation distribution that minimizes AIC/BIC
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Diagnostic Example}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{block}{Verification}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Standardized residuals should be i.i.d. with no residual ARCH effects
        \end{itemize}
    \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_diagnostics.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_diagnostic}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_diagnostic}
\end{frame}

\begin{frame}{GARCH Model Diagnostics}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Standardized Residuals}
        \[
            \hat{z}_t = \frac{\hat{\varepsilon}_t}{\hat{\sigma}_t}
        \]

        If the model is correctly specified, $\hat{z}_t$ should be i.i.d.(0,1).
    \end{block}

    \vspace{0.3cm}

    \begin{block}{Diagnostic Checks}
        \begin{enumerate}\setlength{\itemsep}{0pt}
            \item \textbf{Ljung-Box on $\hat{z}_t$}: check absence of autocorrelation in mean
            \item \textbf{Ljung-Box on $\hat{z}_t^2$}: check absence of residual ARCH effects
            \item \textbf{ARCH-LM test on $\hat{z}_t$}: confirm absence of heteroskedasticity
            \item \textbf{Histogram + QQ-plot}: verify assumed distribution
        \end{enumerate}
    \end{block}
    \end{cminipage}
\end{frame}

\begin{frame}{GARCH Model Comparison: Validation}
    \begin{cminipage}{0.95\textwidth}
    {\small
    \begin{block}{Interpretation}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item GARCH(1,1) achieves the lowest MAE on the validation set
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item More parsimonious and stable than higher-order models
                    \end{itemize}
                \item GARCH(2,1) and GJR-GARCH: similar performance, but more parameters
                \item \textbf{Conclusion}: simplicity wins $\Rightarrow$ GARCH(1,1) is hard to beat
            \end{itemize}
        \end{block}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{GARCH Model Comparison: Validation}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_comparison.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_comparison}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_comparison}
\end{frame}

\begin{frame}{Diebold-Mariano Test}
    \begin{cminipage}{0.95\textwidth}
    \scriptsize
    \setlength{\abovedisplayskip}{2pt}\setlength{\belowdisplayskip}{2pt}
    \vspace{-0.3cm}
    \begin{block}{Motivation}
        Given two competing volatility models, which forecasts better?
    \end{block}
    \vspace{-0.15cm}
    \begin{defn}[Diebold-Mariano (1995)]
        Define the loss differential: $d_t = L(e_{1t}) - L(e_{2t})$
        where $e_{it} = \sigma_t^2 - \hat{\sigma}_{it}^2$ and $L(\cdot)$ is a loss function (e.g., $L(e) = e^2$).
        \[
            DM = \frac{\bar{d}}{\sqrt{\hat{V}(\bar{d})}} \xrightarrow{d} N(0,1) \quad \text{under } H_0: \; \E[d_t] = 0
        \]
    \end{defn}
    \vspace{-0.15cm}
    \begin{alertblock}{Practical Notes}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $H_0$: equal predictive accuracy; rejection $\Rightarrow$ one model is significantly better
            \item Common loss functions: MSE ($e^2$), MAE ($|e|$), QLIKE ($\log \hat{\sigma}^2 + \sigma^2/\hat{\sigma}^2$)
            \item QLIKE is robust to noisy volatility proxies (Patton, 2011)
            \item Use HAC standard errors (Newey-West) if $d_t$ is autocorrelated
        \end{itemize}
    \end{alertblock}
    \begin{exampleblock}{Example}
        EGARCH-t vs GARCH-N on S\&P 500: DM test with QLIKE loss typically rejects $H_0$ in favor of EGARCH-t.
    \end{exampleblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Mincer-Zarnowitz Regression}
    \begin{cminipage}{0.95\textwidth}
    \footnotesize
    \vspace{-0.2cm}
    \begin{block}{Forecast Efficiency Test}
        Regress realized volatility on forecasted volatility:
        \[
            \sigma_{t,\text{realized}}^2 = a + b \, \hat{\sigma}_t^2 + u_t
        \]
    \end{block}
    \vspace{-0.1cm}
    \begin{defn}[Hypotheses]
        $H_0: a = 0, \; b = 1$ \quad (unbiased, efficient forecast)

        Test via F-test or Wald test. Rejection $\Rightarrow$ forecast is biased or inefficient.
    \end{defn}
    \vspace{-0.1cm}
    \begin{exampleblock}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $R^2$ measures fraction of variance explained by the forecast
            \item $b > 1$: forecasts underestimate volatility; $b < 1$: overestimate
            \item $a > 0$: systematic upward bias in realized volatility
        \end{itemize}
    \end{exampleblock}
    \vspace{-0.1cm}
    \begin{alertblock}{Caveat}
        Realized variance ($r_t^2$) is a noisy proxy for $\sigma_t^2$ $\Rightarrow$ $R^2$ typically low ($< 0.10$). Prefer $RV_t$ when available.
    \end{alertblock}
    \end{cminipage}
\end{frame}

%=============================================================================
% SECTION 6: FORECASTING VOLATILITY
%=============================================================================
\section{Volatility Forecasting}

\begin{frame}{Volatility Forecast --- Visualization}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{itemize}\setlength{\itemsep}{0pt}
        \item Forecast converges exponentially to $\bar{\sigma}^2$; speed depends on $\alpha + \beta$
        \item The closer $\alpha + \beta$ is to 1, the slower the convergence
    \end{itemize}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_forecast.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_vol\_forecast}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_vol_forecast}
\end{frame}

\begin{frame}{Forecasting with GARCH(1,1)}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{One-Step-Ahead Forecast}
        $\hat{\sigma}_{T+1}^2 = \omega + \alpha \varepsilon_T^2 + \beta \sigma_T^2$
    \end{block}

    \begin{block}{Multi-Step Forecast}
        For $h > 1$: $\E_T[\sigma_{T+h}^2] = \bar{\sigma}^2 + (\alpha + \beta)^{h-1} (\sigma_{T+1}^2 - \bar{\sigma}^2)$
        where $\bar{\sigma}^2 = \frac{\omega}{1 - \alpha - \beta}$ = unconditional variance.
    \end{block}

    \vspace{0.2cm}

    \begin{exampleblock}{Convergence}
        $\lim_{h \to \infty} \E_T[\sigma_{T+h}^2] = \bar{\sigma}^2$ --- forecast converges to unconditional variance!
    \end{exampleblock}
    \end{cminipage}
\end{frame}

\begin{frame}{GARCH Forecast Convergence to Unconditional Variance}
    \begin{cminipage}{0.95\textwidth}
    {\small
    \begin{block}{Interpretation}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Multi-step forecast converges exponentially to $\bar{\sigma}^2 = \frac{\omega}{1-\alpha-\beta}$
                \item The closer $\alpha + \beta$ is to 1, the slower the convergence
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item S\&P 500: $\alpha + \beta \approx 0.99$ $\Rightarrow$ convergence in $\sim$50 days
                        \item Bitcoin: $\alpha + \beta \approx 0.95$ $\Rightarrow$ faster convergence
                    \end{itemize}
            \end{itemize}
        \end{block}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{GARCH Forecast Convergence to Unconditional Variance}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_convergence.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_convergence}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_convergence}
\end{frame}

\begin{frame}{Conditional vs Unconditional Volatility}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Conditional volatility} $\sigma_t$ (GARCH): time-varying, reacts to news
            \item \textbf{Unconditional volatility} $\bar{\sigma} = \sqrt{\omega/(1-\alpha-\beta)}$: long-run constant level
            \item Red zones: $\sigma_t > \bar{\sigma}$ (high-stress periods); blue zones: $\sigma_t < \bar{\sigma}$ (calm periods)
        \end{itemize}
    \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_cond_vs_uncond.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_cond\_vs\_uncond}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_cond_vs_uncond}
\end{frame}

\begin{frame}{Realized Volatility and HAR-RV}
    \begin{cminipage}{0.95\textwidth}
    \scriptsize
    \setlength{\abovedisplayskip}{2pt}\setlength{\belowdisplayskip}{2pt}
    \vspace{-0.3cm}
    \begin{block}{Realized Volatility (RV)}
        With intraday returns $r_{t,i}$ at frequency $\Delta$ ($M$ observations per day):
        \[
            RV_t = \sum_{i=1}^{M} r_{t,i}^2
        \]
        $RV_t$ is a \textbf{model-free}, \textbf{observable} measure of daily variance (vs.\ GARCH: latent).
    \end{block}
    \vspace{-0.2cm}
    \begin{defn}[HAR-RV Model --- Corsi (2009)]
        \[
            RV_t = \beta_0 + \beta_D \, RV_{t-1} + \beta_W \, RV_{t-1}^{(w)} + \beta_M \, RV_{t-1}^{(m)} + u_t
        \]
        where $RV^{(w)} = \frac{1}{5}\sum_{j=1}^{5} RV_{t-j}$ (weekly) and $RV^{(m)} = \frac{1}{22}\sum_{j=1}^{22} RV_{t-j}$ (monthly).
    \end{defn}
    \vspace{-0.15cm}
    \begin{alertblock}{Key Advantages}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Simple OLS regression that captures \textbf{long memory} in volatility
            \item Heterogeneous traders (daily/weekly/monthly) explain multi-scale dynamics
            \item Often outperforms GARCH when intraday data available (5-min returns, $M \approx 78$/day)
            \item Caveat: microstructure noise at very high frequency $\Rightarrow$ use kernel estimators
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Realized GARCH}
    \begin{cminipage}{0.95\textwidth}
    \scriptsize
    \vspace{-0.3cm}
    \begin{block}{Motivation}
        Standard GARCH treats volatility as \textbf{latent}. With high-frequency data, we can \textbf{observe} it via $RV_t$.
    \end{block}
    \vspace{-0.15cm}
    \begin{defn}[Realized GARCH --- Hansen, Huang \& Shek (2012)]
        \textbf{Return equation}: $r_t = \mu + \sigma_t z_t$, \quad $z_t \sim D(0,1)$

        \textbf{GARCH equation}: $\log \sigma_t^2 = \omega + \beta \log \sigma_{t-1}^2 + \gamma \log RV_{t-1}$

        \textbf{Measurement equation}: $\log RV_t = \xi + \varphi \log \sigma_t^2 + \tau(z_t) + u_t$
    \end{defn}
    \vspace{-0.15cm}
    \begin{exampleblock}{Benefits}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Joint model}: links returns, latent volatility, and realized measures
            \item Leverage function $\tau(z_t)$ captures asymmetry directly
            \item Typically \textbf{more accurate} forecasts than standard GARCH (uses richer information set)
        \end{itemize}
    \end{exampleblock}
    \vspace{-0.15cm}
    \begin{alertblock}{Comparison: GARCH vs HAR-RV vs Realized GARCH}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{GARCH}: no intraday data needed; most widely used
            \item \textbf{HAR-RV}: simple, model-free; requires 5-min data
            \item \textbf{Realized GARCH}: best of both worlds; requires 5-min data + parametric structure
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{VaR and ES: Graphical Illustration}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item VaR 1\% = loss exceeded only in 1\% of cases
            \item Red area = extreme losses (beyond VaR)
        \end{itemize}
    \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_var_illustration.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_var\_plot}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_var_plot}
\end{frame}

\begin{frame}{Applications of Volatility Forecasting}
\small
    \begin{columns}[T]
        \begin{column}{0.5\textwidth}
            \begin{block}{Value at Risk (VaR)}
                $\text{VaR}_\alpha = z_\alpha \cdot \sigma_{T+1}$

                Maximum loss with probability $1-\alpha$.
            \end{block}

            \begin{block}{Expected Shortfall (ES)}
                $\text{ES}_\alpha = \E[-r | r < -\text{VaR}_\alpha]$

                Average loss when VaR is exceeded.
            \end{block}
        \end{column}
        \begin{column}{0.5\textwidth}
            \begin{block}{Other Applications}
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Option pricing
                    \item Dynamic hedging
                    \item Portfolio allocation
                    \item Stress testing
                \end{itemize}
            \end{block}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{VaR vs Expected Shortfall: Normal vs Student-t}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item ES measures average loss when VaR is exceeded
            \item Student-t: VaR and ES are larger than under normal distribution
        \end{itemize}
    \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_var_es_comparison.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_var\_es}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_var_es}
\end{frame}

\begin{frame}{Value at Risk --- Numerical Example}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{exampleblock}{VaR Calculation}
        Portfolio: \textbf{1,000,000 EUR}, forecasted volatility $\hat{\sigma}_{T+1} = 1.5\%$
    \end{exampleblock}

    \begin{block}{VaR with Normal Distribution}
        \begin{center}
            \small
            \begin{tabular}{lccc}
                \toprule
                \textbf{Level} & $\bm{z_\alpha}$ & \textbf{VaR (\%)} & \textbf{VaR (EUR)} \\
                \midrule
                5\% (1 day) & 1.645 & 2.47\% & 24,675 \\
                1\% (1 day) & 2.326 & 3.49\% & 34,890 \\
                \bottomrule
            \end{tabular}
        \end{center}
    \end{block}

    \begin{alertblock}{Scaling for Longer Periods}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item $\text{VaR}_{h\text{ days}} = \text{VaR}_{1\text{ day}} \cdot \sqrt{h}$ --- assumes i.i.d. returns
            \item \textbf{Warning}: Under GARCH models, returns are \textbf{not} i.i.d.\ (they are conditionally heteroskedastic) $\Rightarrow$ the $\sqrt{h}$ rule is only an \textbf{approximation}; for multi-period VaR, use iterated GARCH forecasts
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Value at Risk --- Student-t Distribution}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Why Student-t?}
        Normal distribution \textbf{underestimates} tail risk. Student-t with $\nu$ degrees of freedom better captures fat tails (kurtosis $> 3$).
    \end{block}

    \begin{exampleblock}{VaR 1\% (1 day) Comparison: $\sigma = 1.5\%$, Portfolio = 1M EUR}
        \begin{center}
            \small
            \begin{tabular}{lcc}
                \toprule
                \textbf{Distribution} & \textbf{Quantile} & \textbf{VaR (EUR)} \\
                \midrule
                Normal & 2.326 & 34,890 \\
                Student-t ($\nu = 6$) & 3.143 & 47,145 \\
                Student-t ($\nu = 4$) & 3.747 & 56,205 \\
                \bottomrule
            \end{tabular}
        \end{center}
    \end{exampleblock}

    \begin{alertblock}{Observation}
        With $\nu = 6$ (typical for stocks), VaR is \textbf{35\% higher} than normal!
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{VaR --- Complete Example with GARCH}
    \begin{cminipage}{0.95\textwidth}
    \begin{block}{VaR Calculation Procedure}
        \begin{enumerate}\setlength{\itemsep}{0pt}
            \item Estimate GARCH(1,1) model with Student-t distribution
            \item Obtain volatility forecast: $\hat{\sigma}_{T+1}$
            \item Calculate VaR: $\text{VaR}_\alpha = t_\alpha(\nu) \cdot \hat{\sigma}_{T+1} \cdot \sqrt{\frac{\nu-2}{\nu}}$
        \end{enumerate}
    \end{block}

    \vspace{0.2cm}

    \begin{exampleblock}{Example: S\&P 500}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Estimated parameters: $\alpha = 0.088$, $\beta = 0.900$, $\nu = 6.4$
            \item Forecasted volatility: $\hat{\sigma}_{T+1} = 1.2\%$
            \item Portfolio: 10,000,000 EUR
        \end{itemize}

        \vspace{0.2cm}

        \textbf{VaR 1\% (1 day):}
        $\text{VaR} = 3.05 \times 0.012 \times 10{,}000{,}000 = \textbf{366{,}000 EUR}$
    \end{exampleblock}
    \end{cminipage}
\end{frame}

\begin{frame}{What is VaR Backtesting?}
    \begin{cminipage}{0.95\textwidth}
\small
    \begin{block}{Definition}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Backtesting} = ex-post verification of VaR model quality
            \item Compares realized losses with the forecasted VaR threshold
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item A \textbf{violation} occurs when $r_t < -\text{VaR}_t$
                \end{itemize}
        \end{itemize}
    \end{block}
    \vspace{-0.2cm}
    \begin{block}{Backtesting Principle}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Violation indicator: $I_t = \mathbf{1}(r_t < -\text{VaR}_{\alpha,t})$
            \item For a correctly specified model at level $\alpha$:
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Frequency: $\hat{p} = \frac{1}{T}\sum I_t \approx \alpha$; violations \textbf{independent}
                \end{itemize}
            \item VaR 1\% over 250 days $\Rightarrow$ expect $\sim$2.5 violations/year
        \end{itemize}
    \end{block}
    \vspace{-0.2cm}
    \begin{alertblock}{Importance}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Regulatory requirement under \textbf{Basel III/IV} for banks: backtesting is mandatory
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{VaR Backtesting: Visual Overview}
    \vspace{-0.2cm}
    {\footnotesize
        \begin{block}{Interpretation}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Red line: VaR 1\% threshold estimated with GARCH(1,1)
                \item Red dots: 13 violations out of 250 days ($\hat{p} = 5.2\%$)
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item \textcolor{Crimson}{\textbf{Basel red zone}} $\Rightarrow$ model significantly underestimates risk
                        \item Solutions: Student-t distribution, EGARCH model, or more conservative VaR level
                    \end{itemize}
            \end{itemize}
        \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.47\textheight, keepaspectratio]{garch_var_backtesting.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_backtest}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_backtest}
\end{frame}

\begin{frame}{VaR Backtesting: Basel Traffic Light}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Basel III/IV Traffic Light Zones}
        \begin{center}
            \begin{tabular}{lccc}
                \toprule
                \textbf{Zone} & \textbf{Violations/250 days} & \textbf{Interpretation} & \textbf{Penalty} \\
                \midrule
                \cellcolor{Forest!15}\textcolor{Forest}{\textbf{Green}} & 0--4 & Model acceptable & No penalty \\
                \cellcolor{Amber!15}\textcolor{Amber}{\textbf{Yellow}} & 5--9 & Needs investigation & Factor $k$ increases \\
                \cellcolor{Crimson!15}\textcolor{Crimson}{\textbf{Red}} & $\geq 10$ & Model inadequate & Maximum penalty \\
                \bottomrule
            \end{tabular}
        \end{center}
    \end{block}

    \vspace{0.2cm}

    \begin{exampleblock}{Practical Example}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Portfolio with VaR 1\%: 250 days of backtesting
            \item 3 violations $\Rightarrow$ \textcolor{Forest}{\textbf{Green zone}} $\Rightarrow$ model acceptable
            \item 7 violations $\Rightarrow$ \textcolor{Amber}{\textbf{Yellow zone}} $\Rightarrow$ revision needed
            \item 13 violations $\Rightarrow$ \textcolor{Crimson}{\textbf{Red zone}} $\Rightarrow$ model rejected
        \end{itemize}
    \end{exampleblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Rolling Window VaR Methodology}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.2cm}
    {\small
    \begin{block}{Rolling Window Concept}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item A \textbf{rolling window} of fixed size $W$ (e.g., 500 days) moves day by day
            \item At each step $t$: re-estimate GARCH on $[t-W,\; t-1]$, forecast $\hat{\sigma}_{t|t-1}$, compute VaR$_t$
        \end{itemize}
    \end{block}
    \vspace{-0.2cm}
    \begin{exampleblock}{Step-by-Step Procedure (for each day $t = W+1, \ldots, T$)}
        \begin{enumerate}\setlength{\itemsep}{0pt}
            \item Estimate GARCH on $\{r_{t-W}, \ldots, r_{t-1}\}$ $\Rightarrow$ parameters $\hat{\omega}, \hat{\alpha}, \hat{\beta}, \hat{\nu}$
            \item Forecast: $\hat{\sigma}_{t|t-1}^2 = \hat{\omega} + \hat{\alpha} r_{t-1}^2 + \hat{\beta} \hat{\sigma}_{t-1}^2$
            \item Compute: $\text{VaR}_{\alpha,t} = -t_{\alpha}(\hat{\nu}) \cdot \sqrt{\frac{\hat{\nu}-2}{\hat{\nu}}} \cdot \hat{\sigma}_{t|t-1}$
            \item Check violation: $I_t = \mathbf{1}(r_t < -\text{VaR}_{\alpha,t})$
        \end{enumerate}
    \end{exampleblock}
    \vspace{-0.2cm}
    \begin{alertblock}{Why Rolling and Not Expanding?}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Fixed window: parameters reflect the \textbf{current regime} of volatility
            \item Old data ($> W$ days) may be irrelevant (structural changes, crises)
        \end{itemize}
    \end{alertblock}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{Rolling Window VaR: Procedure Diagram}
    \vspace{-0.3cm}
    \begin{center}
    \begin{tikzpicture}[scale=0.72, every node/.style={font=\scriptsize}]
        % Timeline
        \draw[->, thick] (0,0) -- (12,0) node[right] {Time};

        % Window 1
        \draw[fill=MainBlue!20, draw=MainBlue, thick] (0.5,0.6) rectangle (5.5,1.1);
        \node at (3,0.85) {Window 1: days $1 \ldots W$};
        \draw[->, thick, IDAred] (5.5,0.85) -- (6.3,0.85) node[right] {$\hat{\sigma}_{W+1}$ $\Rightarrow$ VaR$_{W+1}$};

        % Window 2
        \draw[fill=MainBlue!20, draw=MainBlue, thick] (1.0,1.5) rectangle (6.0,2.0);
        \node at (3.5,1.75) {Window 2: days $2 \ldots W\!+\!1$};
        \draw[->, thick, IDAred] (6.0,1.75) -- (6.8,1.75) node[right] {$\hat{\sigma}_{W+2}$ $\Rightarrow$ VaR$_{W+2}$};

        % Window 3
        \draw[fill=MainBlue!20, draw=MainBlue, thick] (1.5,2.4) rectangle (6.5,2.9);
        \node at (4,2.65) {Window 3: days $3 \ldots W\!+\!2$};
        \draw[->, thick, IDAred] (6.5,2.65) -- (7.3,2.65) node[right] {$\hat{\sigma}_{W+3}$ $\Rightarrow$ VaR$_{W+3}$};

        % Dots
        \node at (4.5,3.4) {$\vdots$};

        % Window T
        \draw[fill=MainBlue!20, draw=MainBlue, thick] (4.5,3.8) rectangle (9.5,4.3);
        \node at (7,4.05) {Window $k$: days $k \ldots W\!+\!k\!-\!1$};
        \draw[->, thick, IDAred] (9.5,4.05) -- (10.3,4.05) node[right] {$\hat{\sigma}_{T}$ $\Rightarrow$ VaR$_{T}$};

        % Annotations
        \draw[<->, thick, Forest] (0.5,-0.4) -- (5.5,-0.4) node[midway, below] {$W = 500$ days};
    \end{tikzpicture}
    \end{center}
    \vspace{-0.2cm}
    {\small
    \begin{block}{Result}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item We obtain the series $\{\text{VaR}_{\alpha,t}\}_{t=W+1}^{T}$ $\Rightarrow$ a \textbf{different} threshold every day
            \item VaR adapts to the current regime: increases during volatile periods, decreases during calm ones
            \item Compare $r_t$ with $-\text{VaR}_{\alpha,t}$ to identify violations
        \end{itemize}
    \end{block}
    }
\end{frame}

\begin{frame}{Volatility Forecast with Confidence Intervals}
    \vspace{-0.2cm}
    {\scriptsize
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Forecast converges to $\bar{\sigma}$
            \item Uncertainty increases with forecast horizon
        \end{itemize}
    \end{block}
    }
    \end{cminipage}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_volatility_forecast.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_vol\_ci}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_vol_ci}
\end{frame}

\begin{frame}{Rolling Forecast: Step-by-Step Prediction}
    \vspace{-0.2cm}
    {\small
        \begin{block}{Procedure}
        {\footnotesize
            S\&P 500, W=500, GARCH(1,1)-t
            \begin{itemize}\setlength{\itemsep}{1pt}
                \item Re-estimate GARCH on $[t\!-\!W,\; t\!-\!1]$; forecast $\hat{\sigma}_{t|t-1}$
                \item Compare with realized vol.\ (20-day rolling std.)
            \end{itemize}
        }
        \end{block}
        \vspace{-0.1cm}
        \begin{exampleblock}{Results (2015 days OOS)}
        {\footnotesize
            \begin{itemize}\setlength{\itemsep}{1pt}
                \item $\rho = 0.938$ $\Rightarrow$ excellent tracking; MAE $= 0.15\%$, RMSE $= 0.24\%$
                \item COVID-19: temporary under-prediction, rapid adaptation
            \end{itemize}
        }
        \end{exampleblock}
    }
\end{frame}

\begin{frame}{Rolling Forecast: Step-by-Step Prediction}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_rolling_forecast.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_rolling\_forecast}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_rolling_forecast}
\end{frame}

%=============================================================================
% SECTION 7: PYTHON IMPLEMENTATION
%=============================================================================
\section{Python Implementation}

\begin{frame}{VaR Backtesting: Kupiec Test}
    \begin{block}{Unconditional Coverage Test}
        Tests whether the observed violation rate equals the expected rate $p$ (e.g., 1\% for VaR 1\%).

        \vspace{0.2cm}

        Let $N$ = number of VaR violations, $T$ = total observations, $\hat{p} = N/T$.

        \vspace{0.2cm}

        \textbf{Likelihood Ratio Statistic:}
        \[
            LR_{uc} = -2\ln\left[\frac{(1-p)^{T-N} p^N}{(1-\hat{p})^{T-N} \hat{p}^N}\right] \sim \chi^2(1)
        \]
    \end{block}

    \vspace{0.2cm}

    \begin{alertblock}{Hypotheses}
        \begin{itemize}
            \item $H_0$: $\hat{p} = p$ (VaR model is correctly calibrated)
            \item $H_1$: $\hat{p} \neq p$ (VaR model under- or over-estimates risk)
        \end{itemize}
    \end{alertblock}
\end{frame}

\begin{frame}{VaR Backtesting: Christoffersen Test}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.3cm}
    \begin{block}{Conditional Coverage Test}
        Tests both \textbf{unconditional coverage} and \textbf{independence} of violations.

        Violations should be independent --- no clustering of exceptions!
    \end{block}
    \vspace{-0.1cm}
    \begin{block}{Test Components}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Independence test} ($LR_{ind}$): Tests if violations are serially independent
            \item \textbf{Conditional coverage}: $LR_{cc} = LR_{uc} + LR_{ind} \sim \chi^2(2)$
        \end{itemize}
    \end{block}
    \vspace{-0.1cm}
    \begin{alertblock}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Reject $LR_{uc}$: wrong frequency
            \item Reject $LR_{ind}$: clustered violations
            \item Reject $LR_{cc}$: model fails
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Full Backtesting: Results and Decision}
\small
\begin{block}{Application S\&P 500 (T=500, VaR 1\%)}
    \begin{itemize}\setlength{\itemsep}{0pt}
        \item Rolling window: $W = 500$ days, EGARCH(1,1)-t model
        \item Test window: $T - W$ days out-of-sample
        \item Compare forecasted VaR with realized return each day
    \end{itemize}
\end{block}
\begin{exampleblock}{Typical Output}
    \begin{itemize}\setlength{\itemsep}{0pt}
        \item Number of violations vs expected $\Rightarrow$ Basel zone (green/yellow/red)
        \item Kupiec (frequency): $H_0$: $\hat{p} = \alpha$ $\Rightarrow$ p-value $> 0.05$ $\Rightarrow$ accepted
        \item Christoffersen (independence): $H_0$: violations i.i.d. $\Rightarrow$ p-value $> 0.05$ $\Rightarrow$ accepted
        \item Combined test: both conditions met $\Rightarrow$ \textcolor{Forest}{\textbf{model validated}}
    \end{itemize}
\end{exampleblock}
    \quantlet{TSA\_ch5\_backtest\_full}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_backtest_full}
\end{frame}

\begin{frame}{Expected Shortfall Backtesting}
    \begin{cminipage}{0.95\textwidth}
    \scriptsize
    \setlength{\abovedisplayskip}{2pt}\setlength{\belowdisplayskip}{2pt}
    \vspace{-0.3cm}
    \begin{block}{Why Backtest ES?}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item VaR only measures the \textit{threshold} of extreme losses, not their \textit{magnitude}
            \item ES = average loss \textit{given} VaR is breached $\Rightarrow$ more informative for tail risk
        \end{itemize}
    \end{block}
    \vspace{-0.15cm}
    \begin{defn}[Acerbi-Sz\'ekely Z-test (2014)]
        \[
            Z_{\text{ES}} = \frac{1}{n_\alpha} \sum_{t: r_t < -\text{VaR}_t} \frac{r_t}{\text{ES}_t} + 1
        \]
        Under $H_0$ (correct ES model): $\E[Z_{\text{ES}}] = 0$. Reject if $Z_{\text{ES}} < z_{\alpha/2}$.
    \end{defn}
    \vspace{-0.15cm}
    \begin{alertblock}{Key Insight}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Unlike VaR backtesting (binary hit/miss), ES backtesting uses the \textit{magnitude} of losses
            \item More powerful but requires larger samples ($T > 1000$); alt.: McNeil \& Frey (2000) bootstrap
            \item ES under Student-$t$: $\text{ES}_\alpha^{t_\nu} = -\mu + \sigma \cdot \frac{\nu + (t_{\alpha,\nu})^2}{\nu - 1} \cdot \frac{f_{t_\nu}(t_{\alpha,\nu})}{\alpha}$ --- heavier tails $\Rightarrow$ higher ES
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Basel IV: From VaR to ES}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Regulatory Shift}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Basel II/III}: Capital based on VaR 99\% (10-day)
            \item \textbf{Basel IV} (FRTB, 2023+): Capital based on \textbf{ES 97.5\%} (10-day)
            \item Rationale: ES is \textbf{coherent} (subadditive), VaR is not
        \end{itemize}
    \end{block}
    \vspace{-0.1cm}
    \begin{exampleblock}{Equivalence under Normality}
        \[
            \text{ES}_{97.5\%}^{\text{Normal}} = \frac{\phi(z_{0.025})}{0.025} \cdot \sigma \approx 2.338\,\sigma \quad \approx \quad \text{VaR}_{99\%}^{\text{Normal}} = 2.326\,\sigma
        \]
        $\Rightarrow$ Under normality, ES 97.5\% $\approx$ VaR 99\%. Under fat tails, ES $\gg$ VaR.
    \end{exampleblock}
    \vspace{-0.1cm}
    \begin{alertblock}{Practical Implication}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Student-$t$ GARCH models become \textbf{essential} for accurate ES estimation
            \item Banks must now model the \textit{entire tail}, not just a single quantile
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

%=============================================================================
% SECTION 7b: ARMA-GARCH JOINT MODELING
%=============================================================================

\begin{frame}{ARMA-GARCH: Joint Mean and Variance Modeling}
    \begin{cminipage}{0.95\textwidth}
\small
    \begin{block}{Why Joint Modeling?}
        \textbf{Serial correlation} $\Rightarrow$ ARMA for mean; \textbf{Volatility clustering} $\Rightarrow$ GARCH for variance.
    \end{block}
    \vspace{-0.1cm}
    \begin{defn}[ARMA(p,q)-GARCH(r,s)]
        \textbf{Mean equation}: $r_t = \mu + \sum_{i=1}^{p} \phi_i (r_{t-i} - \mu) + \sum_{j=1}^{q} \theta_j \varepsilon_{t-j} + \varepsilon_t$

        \textbf{Variance equation}: $\varepsilon_t = \sigma_t z_t$, \quad $\sigma_t^2 = \omega + \sum_{i=1}^{r} \alpha_i \varepsilon_{t-i}^2 + \sum_{j=1}^{s} \beta_j \sigma_{t-j}^2$
    \end{defn}
    \end{cminipage}
\end{frame}

\begin{frame}{ARMA-GARCH: Model Selection Strategy}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Step-by-Step Approach}
        \begin{enumerate}\setlength{\itemsep}{0pt}
            \item \textbf{Identify mean model}: Check ACF/PACF of returns for ARMA structure
            \item \textbf{Test for ARCH effects}: Apply ARCH-LM test to residuals
            \item \textbf{Specify variance model}: Usually GARCH(1,1) is sufficient
            \item \textbf{Joint estimation}: Estimate both equations via MLE
            \item \textbf{Diagnostic checking}: Standardized residuals should be i.i.d.
        \end{enumerate}
    \end{block}

    \vspace{0.2cm}

    \begin{alertblock}{Common Specifications}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Stock returns}: AR(1)-GARCH(1,1) or ARMA(1,1)-GARCH(1,1)
            \item \textbf{Exchange rates}: Often just GARCH(1,1) (no mean dynamics)
            \item \textbf{Interest rates}: AR(1)-EGARCH(1,1) for leverage effects
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}[fragile]{Python: GARCH Estimation with \texttt{arch}}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-3mm}
    {\scriptsize
    \begin{block}{Key Steps}
    \begin{lstlisting}
from arch import arch_model
import numpy as np
from scipy.stats import norm
# Fit GARCH(1,1) with Student-t innovations
model = arch_model(returns, vol='Garch', p=1, q=1,
                   dist='StudentsT', mean='AR', lags=1)
result = model.fit(disp='off')
print(result.summary())
# Forecast 20-step ahead volatility
forecast = result.forecast(horizon=20)
sigma_forecast = np.sqrt(forecast.variance.iloc[-1])
# Compute 1-day VaR (1%) from conditional distribution
sigma_1 = sigma_forecast.iloc[0]
VaR_1pct = norm.ppf(0.01) * sigma_1  # Normal approx
    \end{lstlisting}
    \end{block}
    \vspace{-2mm}
    \textbf{Note}: For Student-$t$ VaR, replace \texttt{norm.ppf} with \texttt{scipy.stats.t.ppf(0.01, df=nu)} scaled by $\sqrt{(\nu-2)/\nu}$.
    }
    \end{cminipage}
\end{frame}

%=============================================================================
% SECTION 8: CASE STUDY
%=============================================================================
\section{Case Study: S\&P 500}

\begin{frame}{Step 1: Data --- S\&P 500 Daily Returns}
    \vspace{-0.2cm}
    {\small
        \begin{block}{Data Description}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item \textbf{Source}: Yahoo Finance, S\&P 500, daily data 2000--2024 ($T > 6000$)
                \item \textbf{Returns}: $r_t = \ln(P_t/P_{t-1}) \times 100$
            \end{itemize}
        \end{block}
        \vspace{-0.2cm}
        \begin{exampleblock}{Descriptive Statistics}
            \vspace{-0.1cm}
            \begin{center}
            {\footnotesize
            \begin{tabular}{cccccc}
                \toprule
                Mean & Std. Dev. & Skewness & Kurtosis & Min & Max \\
                \midrule
                0.034\% & 1.21\% & $-0.29$ & 13.8 & $-12.8\%$ & $+11.0\%$ \\
                \bottomrule
            \end{tabular}
            }
            \end{center}
            \vspace{-0.1cm}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Fat tails (kurtosis $\gg 3$) and negative skewness $\Rightarrow$ ARCH effects
            \end{itemize}
        \end{exampleblock}
    }
\end{frame}

\begin{frame}{Step 1: Data --- S\&P 500 Daily Returns}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_sp500_returns.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_sp500}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_sp500}
\end{frame}

\begin{frame}{Step 2: Testing for ARCH Effects}
    \small
    \begin{block}{Python Code --- ARCH-LM and Ljung-Box on $r_t^2$}
    \end{block}
    \begin{exampleblock}{Results}
        {\small
        \begin{tabular}{lcc}
            \toprule
            \textbf{Test} & \textbf{Statistic} & \textbf{p-value} \\
            \midrule
            ARCH-LM (10 lags) & 892.4 & $< 0.0001$ \\
            Ljung-Box $r_t^2$ (lag 20) & 4217.6 & $< 0.0001$ \\
            \bottomrule
        \end{tabular}
        }
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Conclusion}: Strong ARCH effects $\Rightarrow$ significant heteroskedasticity
        \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Step 3: Estimated Parameters --- Comparison}
    \vspace{-0.2cm}
    {\scriptsize
        \begin{block}{Estimated Parameters Table}
            \begin{center}
            \begin{tabular}{lccccccc}
                \toprule
                \textbf{Model} & $\omega$ & $\alpha$ & $\beta$ & $\gamma$ & $\alpha\!+\!\beta$ & $\nu$ & \textbf{HL} \\
                \midrule
                GARCH-N & 0.011 & 0.088 & 0.901 & --- & 0.989 & --- & 60 days \\
                GARCH-t & 0.011 & 0.088 & 0.900 & --- & 0.989 & 6.42 & 60 days \\
                EGARCH-t & 0.003 & 0.103 & 0.987 & $-$0.120 & --- & 6.38 & 53 days \\
                GJR-t & 0.010 & 0.022 & 0.906 & 0.126 & 0.991 & 6.51 & 78 days \\
                \bottomrule
            \end{tabular}
            \end{center}
        \end{block}
        \vspace{-0.1cm}
        \begin{alertblock}{Interpretation}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item EGARCH $\gamma = -0.12$ \textbf{significant} $\Rightarrow$ \textbf{leverage effect confirmed}
                \item GJR: $\alpha_{\text{neg}} = \alpha + \gamma = 0.148$ vs $\alpha_{\text{pos}} = 0.022$ $\Rightarrow$ strong asymmetry
            \end{itemize}
        \end{alertblock}
    }
\end{frame}

\begin{frame}{Step 3: Estimated Conditional Volatility --- S\&P 500}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_sp500_volatility.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_sp500\_garch}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_sp500_garch}
\end{frame}

\begin{frame}{Step 4: Leverage Effect --- Visualization}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{block}{GARCH vs EGARCH --- Volatility Differences}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item EGARCH produces \textbf{higher} volatility after negative shocks (2008, 2020)
                \item Symmetric GARCH \textbf{underestimates} risk during crisis periods
                \item Difference: up to 2--3 percentage points in daily volatility
            \end{itemize}
        \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{garch_sp500_comparison.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_sp500\_comp}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_sp500_comp}
\end{frame}

\begin{frame}{Step 5: Model Selection --- AIC/BIC}
    \begin{cminipage}{0.95\textwidth}
    \begin{block}{Information Criteria}
        \begin{center}
        {\small
        \begin{tabular}{lcccl}
            \toprule
            \textbf{Model} & \textbf{Log-Lik} & \textbf{AIC} & \textbf{BIC} & \textbf{Rank} \\
            \midrule
            GARCH(1,1)-N & $-$8042.3 & 16090.6 & 16111.0 & 4 \\
            GARCH(1,1)-t & $-$7981.5 & 15971.0 & 15997.8 & 3 \\
            EGARCH(1,1)-t & $-$7964.2 & \textbf{15938.4} & \textbf{15971.6} & \textbf{1} \\
            GJR-GARCH(1,1)-t & $-$7968.1 & 15946.2 & 15979.4 & 2 \\
            \bottomrule
        \end{tabular}
        }
        \end{center}
    \end{block}
    \begin{exampleblock}{Decision}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{EGARCH(1,1)-t wins}: lowest AIC \textbf{and} BIC
            \item Student-t superior to Normal ($\Delta$AIC $\approx 120$) $\Rightarrow$ fat tails matter!
            \item Leverage effect justifies asymmetric models ($\Delta$AIC $\approx 33$ vs GARCH-t)
        \end{itemize}
    \end{exampleblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Step 6: Diagnostics --- EGARCH(1,1)-t}
    \begin{cminipage}{0.95\textwidth}
    {\small
    \begin{block}{Checks on Standardized Residuals $z_t = \varepsilon_t / \hat{\sigma}_t$}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item \textbf{Ljung-Box} on $z_t$: p-value $= 0.38$ --- no residual autocorrelation
                \item \textbf{Ljung-Box} on $z_t^2$: p-value $= 0.52$ --- \textbf{ARCH effects eliminated}
                \item \textbf{Q-Q plot}: points follow the theoretical Student-t line
                \item \textbf{Conclusion}: EGARCH(1,1)-t adequately captures volatility dynamics
            \end{itemize}
        \end{block}
    }
    \end{cminipage}
\end{frame}

\begin{frame}{Step 6: Diagnostics --- EGARCH(1,1)-t}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_diagnostics.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_sp500\_diag}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_sp500_diag}
\end{frame}

\begin{frame}{Step 7: Backtesting Rolling VaR --- S\&P 500}
    \vspace{-0.2cm}
    {\small
        \begin{exampleblock}{Kupiec + Christoffersen Results (2015 days out-of-sample)}
            \vspace{-0.1cm}
            \begin{center}
            {\footnotesize
            \begin{tabular}{lccl}
                \toprule
                \textbf{Test} & \textbf{Statistic} & \textbf{p-value} & \textbf{Decision} \\
                \midrule
                Violations & 27/2015 ($\hat{p}=1.34\%$) & --- & \textcolor{Forest}{\textbf{Green}} zone \\
                Kupiec (uc) & 2.13 & 0.145 & \textcolor{Forest}{Accepted} \\
                Christoffersen (ind) & 0.79 & 0.375 & \textcolor{Forest}{Accepted} \\
                Combined (cc) & 2.91 & 0.233 & \textcolor{Forest}{Accepted} \\
                \bottomrule
            \end{tabular}
            }
            \end{center}
        \end{exampleblock}
    }
\end{frame}

\begin{frame}{Step 7: Rolling VaR --- S\&P 500}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_sp500_rolling_var.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_sp500\_var}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_sp500_var}
\end{frame}

\begin{frame}{Step 8: Conclusions --- S\&P 500 Case Study}
    \begin{cminipage}{0.95\textwidth}
    \begin{block}{Step-by-Step Methodology Summary}
        \begin{enumerate}\setlength{\itemsep}{2pt}
            \item \textbf{Data}: log returns, descriptive statistics $\Rightarrow$ fat tails, skewness
            \item \textbf{ARCH test}: ARCH-LM + Ljung-Box on $r_t^2$ $\Rightarrow$ significant ARCH effects
            \item \textbf{Estimation}: 4 candidate models (symmetric/asymmetric $\times$ Normal/Student-t)
            \item \textbf{Selection}: AIC/BIC $\Rightarrow$ \textbf{EGARCH(1,1)-t} winner
            \item \textbf{Diagnostics}: standardized residuals $\Rightarrow$ model adequate
            \item \textbf{VaR}: rolling window + Kupiec/Christoffersen backtesting $\Rightarrow$ model \textbf{validated}
        \end{enumerate}
    \end{block}
    \vspace{0.1cm}
    \begin{alertblock}{Key Lessons}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Student-t distribution is \textbf{essential} for financial data
            \item Leverage effect: asymmetric models \textbf{mandatory} for equities
            \item Systematic backtesting: not just ``looks good'', but \textbf{statistically tested}
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

%=============================================================================
% SECTION 9: CASE STUDY --- Bitcoin
%=============================================================================
\section{Case Study: Bitcoin}

\begin{frame}{Step 1: Data --- Bitcoin Daily Returns}
    \vspace{-0.2cm}
    {\scriptsize
        \begin{block}{Data Description}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item \textbf{Source}: Yahoo Finance (BTC-USD), daily data 2018--2024
                \item Log returns: mean $\approx 0.05\%$, volatility $\approx 3.5\%$
            \end{itemize}
        \end{block}
        \vspace{-0.2cm}
        \begin{exampleblock}{Descriptive Statistics}
            \vspace{-0.1cm}
            \begin{center}
            {\footnotesize
            \begin{tabular}{cccccc}
                \toprule
                Mean & Std. Dev. & Skewness & Kurtosis & Min & Max \\
                \midrule
                0.05\% & 3.48\% & $-0.72$ & 12.1 & $-46.5\%$ & $+22.5\%$ \\
                \bottomrule
            \end{tabular}
            }
            \end{center}
            \vspace{-0.15cm}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Volatility $\sim$3$\times$ higher than S\&P 500
                \item Extreme kurtosis --- high risk of large losses
            \end{itemize}
        \end{exampleblock}
        }
\end{frame}

\begin{frame}{Step 1: Data --- Bitcoin Daily Returns}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{btc_returns.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_btc}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_btc}
\end{frame}

\begin{frame}{Step 2: Testing for ARCH Effects --- Bitcoin}
    \vspace{-0.2cm}
    {\scriptsize
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{btc_squared_returns.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_btc\_arch}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_btc_arch}
\end{frame}

\begin{frame}{Step 3: Conditional Volatility --- Bitcoin}
    \vspace{-0.2cm}
    {\footnotesize
    \begin{block}{GJR-GARCH(1,1)-t Diagnostics}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Ljung-Box on $z_t^2$: p-value $= 0.41$ --- \textbf{ARCH effects eliminated}
                \item Volatility peaks: March 2020 (COVID), May 2022 (Terra/Luna)
                \item Daily volatility: from 1\% (calm periods) to $>$15\% (crises)
            \end{itemize}
        \end{block}
    }
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.50\textheight, keepaspectratio]{ch10_bitcoin_garch.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_btc\_garch}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_btc_garch}
\end{frame}

\begin{frame}{Step 4: Estimation and Model Selection --- Bitcoin}
    \begin{cminipage}{0.95\textwidth}
    \begin{block}{Estimated Parameters}
        \begin{center}
        {\small
        \begin{tabular}{lccccccc}
            \toprule
            \textbf{Model} & $\omega$ & $\alpha$ & $\beta$ & $\gamma$ & $\alpha\!+\!\beta$ & $\nu$ & \textbf{AIC} \\
            \midrule
            GARCH-t & 0.42 & 0.131 & 0.848 & --- & 0.979 & 4.82 & 9284 \\
            EGARCH-t & 0.08 & 0.184 & 0.976 & $-$0.061 & --- & 4.79 & 9276 \\
            GJR-t & 0.40 & 0.088 & 0.854 & 0.078 & 0.976 & 4.85 & \textbf{9271} \\
            \bottomrule
        \end{tabular}
        }
        \end{center}
    \end{block}
    \begin{block}{Interpretation}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{GJR-GARCH-t wins} (lowest AIC)
            \item $\nu \approx 4.8$: \textbf{much heavier tails} than S\&P 500 ($\nu = 6.4$)
            \item $\alpha = 0.131$ (BTC) vs $0.088$ (S\&P) --- Bitcoin reacts faster to news
            \item Leverage effect weaker than for stocks ($\gamma_{\text{BTC}} = 0.078$ vs $0.126$)
        \end{itemize}
    \end{block}
    \end{cminipage}
\end{frame}

\begin{frame}{Step 5: Backtesting Rolling VaR --- Bitcoin}
    \vspace{-0.2cm}
    {\scriptsize
        \begin{block}{Statistical Tests (2421 days out-of-sample)}
            \vspace{-0.15cm}
            \begin{center}
            \begin{tabular}{lccl}
                \toprule
                \textbf{Test} & \textbf{Statistic} & \textbf{p-value} & \textbf{Decision} \\
                \midrule
                Violations & 28/2421 ($\hat{p}=1.16\%$) & --- & \textcolor{Forest}{\textbf{Green}} zone \\
                Kupiec (uc) & 0.57 & 0.450 & \textcolor{Forest}{Accepted} \\
                Christoffersen (ind) & 0.94 & 0.333 & \textcolor{Forest}{Accepted} \\
                Combined (cc) & 1.51 & 0.471 & \textcolor{Forest}{Accepted} \\
                \bottomrule
            \end{tabular}
            \end{center}
            \vspace{-0.15cm}
        \end{block}
        \vspace{-0.15cm}
        \begin{alertblock}{Interpretation}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Volatility ranges from 3\% to 38\% --- rolling window is \textbf{essential}
                \item All tests \textbf{accepted}: model valid for risk management
            \end{itemize}
        \end{alertblock}
    }
\end{frame}

\begin{frame}{Step 5: Rolling VaR --- Bitcoin}
    \begin{center}
        \includegraphics[width=0.95\textwidth, height=0.78\textheight, keepaspectratio]{garch_btc_rolling_var.pdf}
    \end{center}
    \quantlet{TSA\_ch5\_btc\_var}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_btc_var}
\end{frame}

\begin{frame}{Step 5: VaR Rolling Window --- Bitcoin}
    \small
    \begin{block}{Rolling Window GJR-GARCH-t (W=500 days, VaR 1\%)}
    \end{block}
    {\small
    \begin{exampleblock}{Rolling VaR Characteristics Bitcoin (2018--2024)}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Mean VaR: 9.34\% ($\approx$ EUR 93,400 / 1M EUR)
            \item Max VaR: 37.54\% $\Rightarrow$ COVID crash March 2020
            \item Min VaR: 2.90\% $\Rightarrow$ calm period
            \item Bitcoin: rolling VaR $\sim$4$\times$ larger than S\&P 500 at same exposure
        \end{itemize}
    \end{exampleblock}
    }
\end{frame}

\begin{frame}{Final Comparison: S\&P 500 vs Bitcoin}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.3cm}
    {\small
    \begin{block}{Comparative Summary}
        \vspace{-0.1cm}
        \begin{center}
        {\footnotesize
        \begin{tabular}{lcc}
            \toprule
            & \textbf{S\&P 500} & \textbf{Bitcoin} \\
            \midrule
            Average volatility & 1.2\% & 3.5\% \\
            Kurtosis & 13.8 & 12.1 \\
            Student-t $\nu$ & 6.42 & 4.82 \\
            Best model & EGARCH(1,1)-t & GJR-GARCH(1,1)-t \\
            Leverage effect & Strong ($\gamma = -0.12$) & Moderate ($\gamma = 0.078$) \\
            Half-life & $\sim$60 days & $\sim$42 days \\
            Rolling VaR 1\% mean & \textcolor{Forest}{\textbf{2.53\%}} & \textcolor{Forest}{\textbf{9.34\%}} \\
            Rolling VaR 1\% max & \textcolor{Crimson}{\textbf{22.02\%}} (COVID) & \textcolor{Crimson}{\textbf{37.54\%}} (COVID) \\
            Rolling ES 1\% mean & \textcolor{Forest}{\textbf{3.42\%}} & \textcolor{Forest}{\textbf{12.87\%}} \\
            Kupiec & \textcolor{Forest}{\textbf{Accepted}} (p=0.145) & \textcolor{Forest}{\textbf{Accepted}} (p=0.450) \\
            Christoffersen (ind) & \textcolor{Forest}{\textbf{Accepted}} (p=0.375) & \textcolor{Forest}{\textbf{Accepted}} (p=0.333) \\
            \bottomrule
        \end{tabular}
        }
        \end{center}
    \end{block}
    \vspace{-0.1cm}
    \begin{alertblock}{General Conclusion}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Re-estimating GARCH at each step: Kupiec + Christoffersen \textbf{accepted}
            \item Rolling window VaR: \textbf{mandatory} --- static VaR is completely inadequate
            \item Student-t + asymmetric model: \textbf{essential} for both markets
        \end{itemize}
    \end{alertblock}
    }
    \end{cminipage}
\end{frame}

%=============================================================================
% KEY FORMULAS
%=============================================================================
\begin{frame}{Key Formulas}
    \begin{cminipage}{0.95\textwidth}
    \small
    \begin{block}{Volatility Models}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{ARCH(q):} $\sigma_t^2 = \omega + \sum_{i=1}^{q} \alpha_i \varepsilon_{t-i}^2$
            \item \textbf{GARCH(1,1):} $\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2$
            \item \textbf{EGARCH:} $\ln(\sigma_t^2) = \omega + \alpha(|z_{t-1}| - \E[|z|]) + \gamma z_{t-1} + \beta \ln(\sigma_{t-1}^2)$
            \item \textbf{GJR-GARCH:} $\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \gamma \varepsilon_{t-1}^2 I_{t-1} + \beta \sigma_{t-1}^2$
        \end{itemize}
    \end{block}

    \begin{block}{Properties and Measures}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Unconditional variance:} $\bar{\sigma}^2 = \frac{\omega}{1-\alpha-\beta}$ \quad \textbf{Half-life:} $HL = \frac{\ln(0.5)}{\ln(\alpha+\beta)}$
            \item \textbf{VaR:} $\text{VaR}_\alpha = z_\alpha \cdot \sigma_{T+1}$ \quad \textbf{Stationarity:} $\alpha + \beta < 1$
            \item \textbf{ARCH-LM:} $LM = T \cdot R^2 \sim \chi^2(q)$
        \end{itemize}
    \end{block}
    \end{cminipage}
\end{frame}

%=============================================================================
\section{AI Use Case}
%=============================================================================

\begin{frame}{AI Exercise: Critical Thinking}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-3mm}
    \begin{block}{\footnotesize Prompt to test in ChatGPT / Claude / Copilot}
        {\footnotesize
        ``Using yfinance, download daily closing prices for S\&P 500 (\^{}GSPC) from 2018-01-01 to 2024-12-31 (approx.\ 1{,}750 observations). Compute daily log returns. Test for ARCH effects, fit a GARCH(1,1) model, and forecast volatility for the next 20 trading days. Give me complete Python code.''
        }
    \end{block}
    \vspace{-2mm}
    {\footnotesize
    \textbf{Exercise}:
    \begin{enumerate}\setlength{\itemsep}{0pt}
        \item Run the prompt in an LLM of your choice and critically analyze the response.
        \item Does it compute log returns correctly? Does it remove the mean before fitting GARCH?
        \item How does it test for ARCH effects? Does it use Engle's LM test?
        \item Does it separate the mean equation from the variance equation?
        \item Does it discuss asymmetric effects (GJR-GARCH, EGARCH)? Are VaR estimates computed from the conditional distribution?
        \item Identify at least \textbf{two factual errors} or questionable assumptions in the LLM output.
        \item Does the code verify the stationarity constraint $\alpha + \beta < 1$? If not, add it.
        \item Compare the LLM's VaR estimate with the results from this chapter. Are they consistent?
    \end{enumerate}
    }
    \vspace{-2mm}
    \begin{alertblock}{}
        {\footnotesize \textbf{Warning}: AI-generated code may run without errors and look professional. \textit{That does not mean it is correct.}}
    \end{alertblock}
    \end{cminipage}
\end{frame}

%=============================================================================
% SUMMARY
%=============================================================================
\section{Summary}

\begin{frame}{Summary -- Chapter 5: Volatility Models}
\small
    \vspace{-0.2cm}
    \begin{cminipage}{0.95\textwidth}
    \begin{block}{Key Concepts}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{ARCH(q)}: conditional variance depends on past squared errors (Nobel 2003)
            \item \textbf{GARCH(p,q)}: adds variance lags for persistence (GARCH(1,1) in 90\% of cases)
            \item \textbf{EGARCH}: allows leverage effect, no positivity constraints
            \item \textbf{GJR-GARCH/TGARCH}: captures asymmetry with indicator variables
        \end{itemize}
    \end{block}
    \vspace{-0.2cm}
    \begin{block}{Applications}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Risk measurement and forecasting (VaR, ES)
            \item Derivative pricing, dynamic hedging, portfolio management
        \end{itemize}
    \end{block}
    \vspace{-0.2cm}
    \begin{alertblock}{Practical Tip}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Start with GARCH(1,1), check for leverage, choose distribution minimizing AIC/BIC!
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Student-t often superior to normal distribution
                \end{itemize}
        \end{itemize}
    \end{alertblock}
    \end{cminipage}
\end{frame}

%=============================================================================
% QUIZ
%=============================================================================
\section{Quiz}

\begin{frame}{Question 1}
    \begin{cminipage}{0.95\textwidth}
    \begin{alertblock}{Question}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item What best describes the phenomenon of \textit{volatility clustering} in financial series?
        \end{itemize}
    \end{alertblock}

    \vspace{0.3cm}

    \begin{block}{Answer Choices}

        \textcolor{MainBlue}{\textbf{(A)}} Financial returns are normally distributed and independent\\[3pt]

        \textcolor{MainBlue}{\textbf{(B)}} Periods of high volatility are followed by high volatility, and vice versa\\[3pt]

        \textcolor{MainBlue}{\textbf{(C)}} Volatility is constant over time (homoskedasticity)\\[3pt]

        \textcolor{MainBlue}{\textbf{(D)}} Correlation between returns is always positive

    \end{block}
    \end{cminipage}
\end{frame}

\begin{frame}{Question 1: Answer}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.2cm}
    \begin{center}
        \includegraphics[width=0.98\textwidth, height=0.58\textheight, keepaspectratio]{garch_quiz1_volatility_clustering.pdf}
    \end{center}
    \vspace{-3mm}
    {\small
    \begin{exampleblock}{Answer: (B)}
    \begin{itemize}\setlength{\itemsep}{0pt}
        \item Volatility clustering is a fundamental stylized fact of financial series. It implies that conditional variance is \textbf{predictable}, motivating ARCH/GARCH models.
    \end{itemize}
    \end{exampleblock}
    }
    \hfill\quantlet{TSA\_ch5\_quiz1\_volatility\_clustering}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_quiz1_volatility_clustering}
    \end{cminipage}
\end{frame}

\begin{frame}{Question 2}
    \begin{cminipage}{0.95\textwidth}
    \begin{alertblock}{Question}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item What is the main difference between an ARCH(q) and a GARCH(p,q) model?
        \end{itemize}
    \end{alertblock}

    \vspace{0.3cm}

    \begin{block}{Answer Choices}

        \textcolor{MainBlue}{\textbf{(A)}} GARCH models the conditional mean, ARCH models the variance\\[3pt]

        \textcolor{MainBlue}{\textbf{(B)}} ARCH includes lags of conditional variance, GARCH does not\\[3pt]

        \textcolor{MainBlue}{\textbf{(C)}} GARCH adds lags of conditional variance ($\sigma_{t-j}^2$) beyond squared errors\\[3pt]

        \textcolor{MainBlue}{\textbf{(D)}} ARCH is more parsimonious than GARCH

    \end{block}
    \end{cminipage}
\end{frame}

\begin{frame}{Question 2: Answer}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.2cm}
    \begin{center}
        \includegraphics[width=0.98\textwidth, height=0.58\textheight, keepaspectratio]{garch_quiz2_arch_vs_garch.pdf}
    \end{center}
    \vspace{-3mm}
    {\small
    \begin{exampleblock}{Answer: (C)}
    \begin{itemize}\setlength{\itemsep}{0pt}
        \item GARCH(1,1) captures the same persistence as ARCH(q) with only 2 parameters instead of $q$. In practice, GARCH(1,1) is sufficient in 90\% of cases.
    \end{itemize}
    \end{exampleblock}
    }
    \hfill\quantlet{TSA\_ch5\_quiz2\_arch\_vs\_garch}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_quiz2_arch_vs_garch}
    \end{cminipage}
\end{frame}

\begin{frame}{Question 3}
    \begin{cminipage}{0.95\textwidth}
    \begin{alertblock}{Question}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item What is the \textit{leverage effect} and which GARCH models capture it?
        \end{itemize}
    \end{alertblock}

    \vspace{0.3cm}

    \begin{block}{Answer Choices}

        \textcolor{MainBlue}{\textbf{(A)}} Positive shocks increase volatility more; captured by standard GARCH\\[3pt]

        \textcolor{MainBlue}{\textbf{(B)}} Negative shocks increase volatility more; captured by EGARCH and GJR-GARCH\\[3pt]

        \textcolor{MainBlue}{\textbf{(C)}} Volatility is symmetric; captured by all GARCH models\\[3pt]

        \textcolor{MainBlue}{\textbf{(D)}} Financial leverage effect on stock prices; captured by IGARCH

    \end{block}
    \end{cminipage}
\end{frame}

\begin{frame}{Question 3: Answer}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.2cm}
    \begin{center}
        \includegraphics[width=0.98\textwidth, height=0.58\textheight, keepaspectratio]{garch_quiz3_leverage_effect.pdf}
    \end{center}
    \vspace{-3mm}
    {\small
    \begin{exampleblock}{Answer: (B)}
    \begin{itemize}\setlength{\itemsep}{0pt}
        \item Price drops increase volatility \textbf{more} than equivalent price increases. Standard GARCH uses $\varepsilon_{t-1}^2$, losing the sign information.
    \end{itemize}
    \end{exampleblock}
    }
    \hfill\quantlet{TSA\_ch5\_quiz3\_leverage\_effect}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_quiz3_leverage_effect}
    \end{cminipage}
\end{frame}

\begin{frame}{Question 4}
    \begin{cminipage}{0.95\textwidth}
    \begin{alertblock}{Question}
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item What is the stationarity condition for a GARCH(1,1) model?
        \end{itemize}
    \end{alertblock}

    \vspace{0.3cm}

    \begin{block}{Answer Choices}

        \textcolor{MainBlue}{\textbf{(A)}} $\alpha + \beta = 1$\\[3pt]

        \textcolor{MainBlue}{\textbf{(B)}} $\alpha > 0$ and $\beta > 0$\\[3pt]

        \textcolor{MainBlue}{\textbf{(C)}} $\alpha + \beta < 1$, with $\omega > 0$, $\alpha \geq 0$, $\beta \geq 0$\\[3pt]

        \textcolor{MainBlue}{\textbf{(D)}} $\alpha \cdot \beta < 1$

    \end{block}
    \end{cminipage}
\end{frame}

\begin{frame}{Question 4: Answer}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.2cm}
    \begin{center}
        \includegraphics[width=0.98\textwidth, height=0.58\textheight, keepaspectratio]{garch_quiz4_stationarity.pdf}
    \end{center}
    \vspace{-3mm}
    {\small
    \begin{exampleblock}{Answer: (C)}
    \begin{itemize}\setlength{\itemsep}{0pt}
        \item This ensures a finite unconditional variance $\bar{\sigma}^2 = \frac{\omega}{1-\alpha-\beta}$. When $\alpha + \beta = 1$ (IGARCH), variance is infinite.
    \end{itemize}
    \end{exampleblock}
    }
    \hfill\quantlet{TSA\_ch5\_quiz4\_stationarity}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_quiz4_stationarity}
    \end{cminipage}
\end{frame}

\begin{frame}{Question 5}
    \begin{cminipage}{0.95\textwidth}
    \begin{alertblock}{Applied Computational Question}
        {\small
        A GARCH(1,1) model estimated on daily log returns (\%) gives:
        $\omega = 0.05$, $\alpha = 0.15$, $\beta = 0.82$.

        \begin{enumerate}\setlength{\itemsep}{1pt}
            \item[(a)] Compute the unconditional variance $\bar{\sigma}^2$ and annualized volatility.
            \item[(b)] Compute the half-life of a volatility shock.
            \item[(c)] For a EUR\,2\,000\,000 portfolio, compute the 1-day VaR at 1\% under:
                \begin{itemize}\setlength{\itemsep}{0pt}
                    \item Normal distribution
                    \item Student-$t$ with $\nu = 5$ degrees of freedom
                \end{itemize}
                (Use $\sigma_{T+1} = \bar{\sigma}$ for simplicity.)
        \end{enumerate}
        }
    \end{alertblock}
    \end{cminipage}
\end{frame}

\begin{frame}{Question 5: Answer}
    \begin{cminipage}{0.95\textwidth}
    \vspace{-0.2cm}
    {\small
    \begin{exampleblock}{Solution}
    \begin{itemize}\setlength{\itemsep}{1pt}
        \item[(a)] $\bar{\sigma}^2 = \frac{\omega}{1 - \alpha - \beta} = \frac{0.05}{1 - 0.97} = 1.667$ \quad $\Rightarrow$ $\bar{\sigma} = 1.291\%$ daily
            \quad $\sigma_{\text{ann}} = 1.291\% \times \sqrt{252} \approx 20.5\%$
        \item[(b)] $HL = \frac{\ln 0.5}{\ln(\alpha + \beta)} = \frac{-0.693}{\ln(0.97)} = \frac{-0.693}{-0.0305} \approx \textbf{23 days}$
        \item[(c)] Portfolio value $V = 2{,}000{,}000$ EUR, $\sigma_{T+1} = 1.291\%$:

            \textbf{Normal}: $\text{VaR}_{1\%} = 2.326 \times 0.01291 \times 2{,}000{,}000 = \textbf{60{,}066}$ EUR

            \textbf{Student-$t$(5)}: $t_{0.01,5} = 3.365$ scaled by $\sqrt{(\nu-2)/\nu} = \sqrt{3/5}$:

            $\text{VaR}_{1\%} = \frac{3.365}{\sqrt{5/3}} \times 0.01291 \times 2{,}000{,}000 = \textbf{67{,}300}$ EUR \quad (\textbf{+12\%} vs Normal!)
    \end{itemize}
    \end{exampleblock}
    }
    \begin{center}
        \includegraphics[width=0.70\textwidth, height=0.28\textheight, keepaspectratio]{garch_quiz5_halflife.pdf}
    \end{center}
    \hfill\quantlet{TSA\_ch5\_quiz5\_halflife}{https://github.com/QuantLet/TSA/tree/main/TSA_ch5/TSA_ch5_quiz5_halflife}
    \end{cminipage}
\end{frame}

\begin{frame}{References I}
    \begin{block}{Fundamental ARCH/GARCH Papers}
        {\small
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Engle, R.F. (1982). Autoregressive Conditional Heteroscedasticity with Estimates of the Variance of UK Inflation, \textit{Econometrica}, 50(4), 987--1007.
            \item Bollerslev, T. (1986). Generalized Autoregressive Conditional Heteroskedasticity, \textit{Journal of Econometrics}, 31(3), 307--327.
            \item Nelson, D.B. (1991). Conditional Heteroskedasticity in Asset Returns: A New Approach, \textit{Econometrica}, 59(2), 347--370.
        \end{itemize}
        }
    \end{block}

    \begin{exampleblock}{Asymmetric Models and Extensions}
        {\small
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Glosten, L.R., Jagannathan, R., \& Runkle, D.E. (1993). On the Relation Between the Expected Value and the Volatility of the Nominal Excess Return on Stocks, \textit{Journal of Finance}, 48(5), 1779--1801.
            \item Francq, C., \& Zakoan, J.-M. (2019). \textit{GARCH Models: Structure, Statistical Inference and Financial Applications}, 2nd ed., Wiley.
        \end{itemize}
        }
    \end{exampleblock}
\end{frame}

\begin{frame}{References II}
    \begin{block}{Textbooks and Financial Applications}
        {\small
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Tsay, R.S. (2010). \textit{Analysis of Financial Time Series}, 3rd ed., Wiley.
            \item Franke, J., Hrdle, W.K., \& Hafner, C.M. (2019). \textit{Statistics of Financial Markets}, 4th ed., Springer.
            \item McNeil, A.J., Frey, R., \& Embrechts, P. (2015). \textit{Quantitative Risk Management}, 2nd ed., Princeton University Press.
        \end{itemize}
        }
    \end{block}

    \begin{exampleblock}{Online Resources and Code}
        {\small
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item \textbf{Quantlet}: \url{https://quantlet.com} -- Code platform for quantitative methods
            \item \textbf{Quantinar}: \url{https://quantinar.com} -- Learning platform for quantitative methods
            \item \textbf{GitHub TSA}: \url{https://github.com/QuantLet/TSA/tree/main/TSA_ch5} -- Python code for this chapter
        \end{itemize}
        }
    \end{exampleblock}
\end{frame}

\begin{frame}{Multivariate GARCH: Extensions for Portfolios}
    \begin{cminipage}{0.95\textwidth}
        \small
        \begin{block}{Why Multivariate GARCH?}
            \begin{itemize}\setlength{\itemsep}{0pt}
                \item Portfolios require the conditional covariance matrix $\mathbf{H}_t = \mathrm{Cov}(\mathbf{r}_t \mid \mathcal{F}_{t-1})$
                \item $K$ assets $\Rightarrow$ $K(K+1)/2$ unique elements in $\mathbf{H}_t$ $\Rightarrow$ dimensionality explosion
            \end{itemize}
        \end{block}
        \vspace{-0.2cm}
        \begin{columns}[T]
            \begin{column}{0.48\textwidth}
                \begin{exampleblock}{DCC (Engle, 2002)}
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item $\mathbf{H}_t = \mathbf{D}_t \mathbf{R}_t \mathbf{D}_t$
                        \item $\mathbf{D}_t = \mathrm{diag}(\sigma_{1,t}, \ldots, \sigma_{K,t})$ --- univariate GARCH
                        \item $\mathbf{R}_t$ --- dynamic correlations (2 parameters)
                        \item \textbf{Advantage}: 2-stage estimation, scalable
                        \item \textbf{Limitation}: symmetric correlations
                    \end{itemize}
                \end{exampleblock}
            \end{column}
            \begin{column}{0.48\textwidth}
                \begin{alertblock}{BEKK (Engle-Kroner, 1995)}
                    \begin{itemize}\setlength{\itemsep}{0pt}
                        \item $\mathbf{H}_t = \mathbf{C}'\mathbf{C} + \mathbf{A}'\boldsymbol{\epsilon}_{t-1}\boldsymbol{\epsilon}_{t-1}'\mathbf{A} + \mathbf{B}'\mathbf{H}_{t-1}\mathbf{B}$
                        \item Guarantees $\mathbf{H}_t \succ 0$ (positive-definite)
                        \item \textbf{Advantage}: fully flexible model
                        \item \textbf{Limitation}: $K^2$ parameters per matrix $\Rightarrow$ practical only for $K \leq 3$
                    \end{itemize}
                \end{alertblock}
            \end{column}
        \end{columns}
        \vspace{0.1cm}
        {\scriptsize
        \begin{block}{Python Implementation}
            \texttt{from arch.univariate import ARCHModel} --- DCC via \texttt{rmgarch} (R) or \texttt{mgarch} (Python/Stata)
        \end{block}
        }
    \end{cminipage}
\end{frame}

\begin{frame}{References III}
    \begin{block}{Estimation and Evaluation}
        {\small
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item White, H. (1982). Maximum Likelihood Estimation of Misspecified Models, \textit{Econometrica}, 50(1), 1--25.
            \item Hansen, P.R., \& Lunde, A. (2005). A Forecast Comparison of Volatility Models: Does Anything Beat a GARCH(1,1)?, \textit{Journal of Applied Econometrics}, 20(7), 873--889.
            \item Hansen, P.R., Huang, Z., \& Shek, H.H. (2012). Realized GARCH: A Joint Model for Returns and Realized Measures of Volatility, \textit{Journal of Applied Econometrics}, 27(6), 877--906.
        \end{itemize}
        }
    \end{block}

    \begin{exampleblock}{High-Frequency and Risk Management}
        {\small
        \begin{itemize}\setlength{\itemsep}{0pt}
            \item Corsi, F. (2009). A Simple Approximate Long-Memory Model of Realized Volatility, \textit{Journal of Financial Econometrics}, 7(2), 174--196.
            \item Patton, A.J. (2011). Volatility Forecast Comparison Using Imperfect Volatility Proxies, \textit{Journal of Econometrics}, 160(1), 246--256.
            \item Acerbi, C., \& Sz\'ekely, B. (2014). Backtesting Expected Shortfall, \textit{Risk Magazine}, December.
        \end{itemize}
        }
    \end{exampleblock}
\end{frame}

\begin{frame}{}
    \centering
    \Huge\textcolor{MainBlue}{Thank You!}

    \vspace{1cm}

    \Large Questions?

    \vspace{0.8cm}

    \normalsize

    Course materials available at: \url{https://danpele.github.io/Time-Series-Analysis/}

    \vspace{0.2cm}

    \href{https://quantlet.com}{\raisebox{-0.15em}{\includegraphics[height=0.8em]{ql_logo.png}} Quantlet} \hspace{0.5cm}
    \href{https://quantinar.com}{\raisebox{-0.15em}{\includegraphics[height=0.8em]{qr_logo.png}} Quantinar}
\end{frame}

\end{document}
